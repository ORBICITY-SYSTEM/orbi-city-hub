import{r as u,af as ge,j as e,am as ye,an as Fe,ao as K,ap as je,a3 as se,F as ve,aq as we,ar as Ne,as as be,at as Ue,au as Re,av as ke,n as ce,ag as Se,ah as Ce,u as _e,aj as De,aw as pe,I as Ee,i as Ae,$ as Be}from"./react-vendor-BIDRRw8F.js";import{C as E,B as _,D as ze,e as Le,f as Te,g as $e,h as Ie}from"./index-BLcOQO7i.js";import{s as w}from"./client-C3pdvDkS.js";import{D as Oe,a as qe,b as Ve,c as he,S as Ye}from"./dropdown-menu-C877qG3u.js";import{I as T}from"./input-BuEOZAZD.js";import{L as B}from"./label-KexGf_ya.js";import{S as le,a as oe,b as ie,c as re,d as I}from"./select-ANAJPCoK.js";import{u as fe}from"./use-toast-2UsIGyGT.js";import{aj as ue,ak as R,al as Me,X as te,am as ae}from"./vendor-INCMKllo.js";import{A as Pe,a as Ke,b as He}from"./alert-DhTQNDzo.js";import"./trpc-vendor-wm-eNDph.js";function Qe(s){const n=Object.keys(s).filter(o=>o.toLowerCase().includes("channel")||o.toLowerCase().includes("áƒ¬áƒ§áƒáƒ áƒ")||o.toLowerCase().includes("source")||o.toLowerCase().includes("áƒáƒ áƒ®")||o.toLowerCase().includes("platform"));for(const o of n){const i=s[o];if(i&&String(i).trim())return Ge(String(i).trim())}return"Unknown"}function Ge(s){if(!s)return"Unknown";const n=String(s).toLowerCase().trim();return n.includes("direct")||n.includes("áƒáƒ˜áƒ áƒ“áƒáƒáƒ˜áƒ ")||n.includes("google")||n.includes("facebook")||n.includes("instagram")||n.includes("social")?"Social Media":n.includes("booking")?"Booking.com":n.includes("agoda")?"Agoda":n.includes("expedia")?"Expedia":n.includes("airbnb")?"Airbnb":n.includes("ostrovok")?"Ostrovok":s}function We(s){const n=s.match(/([A-Z]\s)?(\d+)-(\d+)/);if(n){const o=n[1]||"",i=parseInt(n[2]),x=parseInt(n[3]);return[`${o}${i}`.trim(),`${o}${x}`.trim()]}return[s.trim()]}function me(s){if(typeof s=="number"){const n=new Date(1899,11,30);return new Date(n.getTime()+s*24*60*60*1e3)}return new Date(s)}function Xe(s,n,o,i){const x=new Date(o,i-1,1),h=new Date(o,i,0,23,59,59);return n>x&&s<=h}function Ze(s,n,o,i){const x=new Date(o,i-1,1),h=new Date(o,i,1),M=s>x?s:x,m=n<h?n:h;if(m<=M)return 0;const g=(m.getTime()-M.getTime())/(1e3*60*60*24);return Math.max(0,Math.floor(g))}async function Je(s,n,o){return new Promise((i,x)=>{const h=new FileReader;h.onload=M=>{try{const m=new Uint8Array(M.target?.result),f=ue(m,{type:"array"}),g=f.Sheets[f.SheetNames[0]],F=R.sheet_to_json(g),N=[],D=new Map,k=new Map,d=new Map;let j=0,y=0,b=0;const l=new Set;F.forEach(t=>{const a=t.áƒœáƒáƒ›áƒ”áƒ áƒ˜||t.Room||"",A=t.áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ||t["Check-in"]||"",C=t.áƒ’áƒáƒ¡áƒ•áƒšáƒ||t["Check-out"]||"",L=parseInt(t.áƒ®áƒáƒœáƒ’áƒ áƒ«áƒšáƒ˜áƒ•áƒáƒ‘áƒ||t.Nights||"0"),W=parseFloat(String(t.áƒ—áƒáƒœáƒ®áƒ||t.Revenue||"0").replace(/,/g,"")),X=Qe(t),Z=t.áƒ‘áƒšáƒáƒ™áƒ˜||t.Building||"Unknown";if(!a||!A||L<=0||W<=0)return;const J=me(A),ee=me(C);if(!Xe(J,ee,n,o))return;const $=Ze(J,ee,n,o);if($<=0)return;const z=We(a),O=W/L*$/z.length,q=$/z.length;z.forEach(ne=>{l.add(ne),j+=O,y+=q,b+=1/z.length;const V=D.get(ne)||{revenue:0,nights:0,bookings:0};V.revenue+=O,V.nights+=q,V.bookings+=1/z.length,D.set(ne,V);const Y=k.get(X)||{revenue:0,nights:0,bookings:0};Y.revenue+=O,Y.nights+=q,Y.bookings+=1/z.length,k.set(X,Y);const P=d.get(Z)||{revenue:0,nights:0,bookings:0};P.revenue+=O,P.nights+=q,P.bookings+=1/z.length,d.set(Z,P)}),N.push({...t,"áƒœáƒáƒ›áƒ”áƒ áƒ˜ / Room":a,"áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ / Check-in":J.toLocaleDateString("ka-GE"),"áƒ’áƒáƒ¡áƒ•áƒšáƒ / Check-out":ee.toLocaleDateString("ka-GE"),"áƒ¦áƒáƒ›áƒ”áƒ”áƒ‘áƒ˜ áƒ—áƒ•áƒ”áƒ¨áƒ˜ / Nights in Month":$,"áƒ—áƒáƒœáƒ®áƒ áƒ—áƒ•áƒ”áƒ¨áƒ˜ / Revenue in Month":W*($/L),"áƒáƒ áƒ®áƒ˜ / Channel":X,"áƒ‘áƒšáƒáƒ™áƒ˜ / Building":Z})});const p=new Date(n,o,0).getDate(),v=l.size*p,U=v>0?y/v*100:0,S=v>0?j/v:0,H=Array.from(D.entries()).sort((t,a)=>a[1].revenue-t[1].revenue).map(([t,a])=>({room:t,revenue:a.revenue,nights:a.nights,bookings:a.bookings,adr:a.nights>0?a.revenue/a.nights:0})),Q=Array.from(k.entries()).sort((t,a)=>a[1].revenue-t[1].revenue).map(([t,a])=>({channel:t,revenue:a.revenue,nights:a.nights,bookings:a.bookings,adr:a.nights>0?a.revenue/a.nights:0})),G=Array.from(d.entries()).sort((t,a)=>a[1].revenue-t[1].revenue).map(([t,a])=>({building:t,revenue:a.revenue,nights:a.nights,bookings:a.bookings,adr:a.nights>0?a.revenue/a.nights:0})),r={monthlyStats:[{month:`${n}-${String(o).padStart(2,"0")}`,totalRevenue:j,totalNights:y,totalBookings:b,avgADR:y>0?j/y:0,roomCount:l.size,occupancyRate:U}],roomStats:H,channelStats:Q,buildingStats:G,overallStats:{totalRevenue:j,totalNights:y,totalBookings:b,avgADR:y>0?j/y:0,uniqueRooms:l.size,occupancyRate:U,revPAR:S},filteredData:N};i(r)}catch(m){x(m)}},h.onerror=()=>x(new Error("Failed to read file")),h.readAsArrayBuffer(s)})}const en=[{name:"room_number",possibleNames:["áƒœáƒáƒ›áƒ”áƒ áƒ˜","room","room number","room_number","apartment","áƒáƒáƒáƒ áƒ¢áƒáƒ›áƒ”áƒœáƒ¢áƒ˜"],description:"áƒáƒ—áƒáƒ®áƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜ (áƒœáƒáƒ›áƒ”áƒ áƒ˜ / Room)"},{name:"check_in",possibleNames:["áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ","check-in","check in","checkin","arrival","áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜"],description:"áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜ (áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ / Check-in)"},{name:"check_out",possibleNames:["áƒ’áƒáƒ¡áƒ•áƒšáƒ","check-out","check out","checkout","departure","áƒ’áƒáƒ¡áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜"],description:"áƒ’áƒáƒ¡áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜ (áƒ’áƒáƒ¡áƒ•áƒšáƒ / Check-out)"},{name:"revenue",possibleNames:["áƒ—áƒáƒœáƒ®áƒ","revenue","amount","price","total","áƒ¦áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ”áƒ‘áƒ","áƒ¤áƒáƒ¡áƒ˜"],description:"áƒ—áƒáƒœáƒ®áƒ (áƒ—áƒáƒœáƒ®áƒ / Revenue)"}];async function nn(s){const n={isValid:!0,errors:[],warnings:[],detectedColumns:[]};try{const o=s.name.split(".").pop()?.toLowerCase();if(!o||!["xlsx","xls"].includes(o))return n.isValid=!1,n.errors.push("áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ˜ áƒáƒ áƒáƒ¡áƒ¬áƒáƒ áƒ˜áƒ. áƒ’áƒ—áƒ®áƒáƒ•áƒ— áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒáƒ— .xlsx áƒáƒœ .xls áƒ¤áƒáƒ˜áƒšáƒ˜"),n;const i=20*1024*1024;if(s.size>i)return n.isValid=!1,n.errors.push(`áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ«áƒáƒšáƒ˜áƒáƒœ áƒ“áƒ˜áƒ“áƒ˜áƒ (${(s.size/1024/1024).toFixed(2)}MB). áƒ›áƒáƒ¥áƒ¡áƒ˜áƒ›áƒáƒšáƒ£áƒ áƒ˜ áƒ–áƒáƒ›áƒ: 20MB`),n;const x=await s.arrayBuffer(),h=ue(x,{type:"array"});if(h.SheetNames.length===0)return n.isValid=!1,n.errors.push("Excel áƒ¤áƒáƒ˜áƒšáƒ˜ áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜áƒ - áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒáƒ áƒªáƒ”áƒ áƒ—áƒ˜ áƒ¤áƒ£áƒ áƒªáƒ”áƒšáƒ˜"),n;const M=h.SheetNames[0],m=h.Sheets[M],f=R.sheet_to_json(m,{header:1});if(f.length===0)return n.isValid=!1,n.errors.push("Excel áƒ¤áƒáƒ˜áƒšáƒ˜ áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜áƒ - áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜"),n;const g=f[0].map(d=>String(d||"").trim().toLowerCase());n.detectedColumns=f[0];const F=[];for(const d of en)d.possibleNames.some(y=>g.some(b=>b.includes(y.toLowerCase())))||F.push(d.description);F.length>0&&(n.isValid=!1,n.errors.push("áƒ¤áƒáƒ˜áƒšáƒ¨áƒ˜ áƒáƒ™áƒšáƒ˜áƒ áƒ¡áƒáƒ­áƒ˜áƒ áƒ áƒ¡áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜:"),F.forEach(d=>{n.errors.push(`  âŒ ${d}`)})),f.length<2&&n.warnings.push("áƒ¤áƒáƒ˜áƒšáƒ¨áƒ˜ áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜ (áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ¡áƒáƒ—áƒáƒ£áƒ áƒ”áƒ‘áƒ˜)"),g.some(d=>d.includes("áƒ®áƒáƒœáƒ’áƒ áƒ«áƒšáƒ˜áƒ•áƒáƒ‘áƒ")||d.includes("nights")||d.includes("duration")||d.includes("áƒ¦áƒáƒ›áƒ”áƒ”áƒ‘áƒ˜"))||n.warnings.push('áƒáƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ "áƒ¦áƒáƒ›áƒ”áƒ”áƒ‘áƒ˜áƒ¡" áƒ¡áƒ•áƒ”áƒ¢áƒ˜ - áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ áƒ“áƒáƒ˜áƒ—áƒ•áƒšáƒ˜áƒ¡ áƒáƒ•áƒ¢áƒáƒ›áƒáƒ¢áƒ£áƒ áƒáƒ“ Check-in áƒ“áƒ Check-out áƒ—áƒáƒ áƒ˜áƒ¦áƒ”áƒ‘áƒ˜áƒ“áƒáƒœ'),g.some(d=>d.includes("áƒ¬áƒ§áƒáƒ áƒ")||d.includes("channel")||d.includes("source")||d.includes("áƒáƒ áƒ®")||d.includes("platform"))||n.warnings.push('áƒáƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ "áƒáƒ áƒ®áƒ˜áƒ¡" áƒ¡áƒ•áƒ”áƒ¢áƒ˜ - áƒáƒ áƒ®áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜ áƒ¨áƒ”áƒ–áƒ¦áƒ£áƒ“áƒ£áƒšáƒ˜ áƒ˜áƒ¥áƒœáƒ”áƒ‘áƒ'),g.some(d=>d.includes("áƒ‘áƒšáƒáƒ™áƒ˜")||d.includes("building")||d.includes("block"))||n.warnings.push('áƒáƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ "áƒ‘áƒšáƒáƒ™áƒ˜áƒ¡" áƒ¡áƒ•áƒ”áƒ¢áƒ˜ - áƒ‘áƒšáƒáƒ™áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ— áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜ áƒ¨áƒ”áƒ–áƒ¦áƒ£áƒ“áƒ£áƒšáƒ˜ áƒ˜áƒ¥áƒœáƒ”áƒ‘áƒ')}catch(o){n.isValid=!1,n.errors.push(`áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ¬áƒáƒ™áƒ˜áƒ—áƒ®áƒ•áƒ˜áƒ¡áƒáƒ¡ áƒ›áƒáƒ®áƒ“áƒ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ: ${o instanceof Error?o.message:"áƒ£áƒªáƒœáƒáƒ‘áƒ˜ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ"}`)}return n}function tn(s){const n=[];return s.errors.length>0&&n.push(`âŒ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ”áƒ‘áƒ˜:
`+s.errors.join(`
`)),s.warnings.length>0&&n.push(`âš ï¸ áƒ’áƒáƒ¤áƒ áƒ—áƒ®áƒ˜áƒšáƒ”áƒ‘áƒ”áƒ‘áƒ˜:
`+s.warnings.join(`
`)),n.join(`

`)}function an(){const n=[["áƒœáƒáƒ›áƒ”áƒ áƒ˜ / Room","áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ / Check-in","áƒ’áƒáƒ¡áƒ•áƒšáƒ / Check-out","áƒ®áƒáƒœáƒ’áƒ áƒ«áƒšáƒ˜áƒ•áƒáƒ‘áƒ / Nights","áƒ—áƒáƒœáƒ®áƒ / Revenue","áƒ¬áƒ§áƒáƒ áƒ / Channel","áƒ‘áƒšáƒáƒ™áƒ˜ / Building"],["A 4022","2025-10-01","2025-10-05",4,800,"Booking.com","A"],["B 3015","2025-10-03","2025-10-07",4,950,"Airbnb","B"],["A 4025","2025-10-05","2025-10-12",7,1400,"Direct","A"],["C 2008","2025-10-08","2025-10-15",7,1050,"Agoda","C"],["4022-4024","2025-10-10","2025-10-14",4,1600,"Expedia","A"],["B 3020","2025-10-12","2025-10-20",8,1280,"Booking.com","B"],["A 4030","2025-10-15","2025-10-18",3,600,"Social Media","A"],["C 2012","2025-10-18","2025-10-25",7,1120,"Direct","C"]],o=R.book_new(),i=R.aoa_to_sheet(n);i["!cols"]=[{wch:15},{wch:15},{wch:15},{wch:18},{wch:15},{wch:18},{wch:15}];const x=R.decode_range(i["!ref"]||"A1");for(let g=x.s.c;g<=x.e.c;g++){const F=R.encode_cell({r:0,c:g});i[F]&&(i[F].s={font:{bold:!0,sz:12},fill:{fgColor:{rgb:"4472C4"}},alignment:{horizontal:"center",vertical:"center"}})}R.book_append_sheet(o,i,"Bookings Template");const h=[["ğŸ“‹ Orbi City - Excel áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ˜áƒ¡ áƒ˜áƒœáƒ¡áƒ¢áƒ áƒ£áƒ¥áƒªáƒ˜áƒ"],[""],["áƒ¡áƒáƒ­áƒ˜áƒ áƒ áƒ¡áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜:"],["1. áƒœáƒáƒ›áƒ”áƒ áƒ˜ / Room","áƒáƒ—áƒáƒ®áƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜ (áƒ›áƒáƒ’: A 4022, 4022-4024)"],["2. áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ / Check-in","áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜ (YYYY-MM-DD áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ¨áƒ˜)"],["3. áƒ’áƒáƒ¡áƒ•áƒšáƒ / Check-out","áƒ’áƒáƒ¡áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜ (YYYY-MM-DD áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ¨áƒ˜)"],["4. áƒ—áƒáƒœáƒ®áƒ / Revenue","áƒ¯áƒáƒ•áƒ¨áƒœáƒ˜áƒ¡ áƒ—áƒáƒœáƒ®áƒ (áƒ áƒ˜áƒªáƒ®áƒ•áƒ˜)"],[""],["áƒ áƒ”áƒ™áƒáƒ›áƒ”áƒœáƒ“áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ¡áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜:"],["5. áƒ®áƒáƒœáƒ’áƒ áƒ«áƒšáƒ˜áƒ•áƒáƒ‘áƒ / Nights","áƒ¦áƒáƒ›áƒ”áƒ”áƒ‘áƒ˜áƒ¡ áƒ áƒáƒáƒ“áƒ”áƒœáƒáƒ‘áƒ (áƒ—áƒ£ áƒáƒ  áƒáƒ áƒ˜áƒ¡, áƒ“áƒáƒ˜áƒ—áƒ•áƒšáƒ”áƒ‘áƒ áƒáƒ•áƒ¢áƒáƒ›áƒáƒ¢áƒ£áƒ áƒáƒ“)"],["6. áƒ¬áƒ§áƒáƒ áƒ / Channel","áƒ‘áƒ áƒáƒœáƒ˜áƒ áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒ áƒ®áƒ˜ (áƒ›áƒáƒ’: Booking.com, Airbnb, Direct)"],["7. áƒ‘áƒšáƒáƒ™áƒ˜ / Building","áƒ¨áƒ”áƒœáƒáƒ‘áƒ˜áƒ¡ áƒ‘áƒšáƒáƒ™áƒ˜ (áƒ›áƒáƒ’: A, B, C)"],[""],["áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ•áƒáƒœáƒ˜:"],["â€¢ áƒ¨áƒ”áƒ’áƒ˜áƒ«áƒšáƒ˜áƒáƒ— áƒ’áƒáƒ›áƒáƒ˜áƒ§áƒ”áƒœáƒáƒ— áƒ áƒáƒ’áƒáƒ áƒª áƒ¥áƒáƒ áƒ—áƒ£áƒšáƒ˜, áƒ˜áƒ¡áƒ” áƒ˜áƒœáƒ’áƒšáƒ˜áƒ¡áƒ£áƒ áƒ˜ áƒ¡áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ”áƒ‘áƒ˜"],["â€¢ áƒ—áƒáƒ áƒ˜áƒ¦áƒ”áƒ‘áƒ˜ áƒ£áƒœáƒ“áƒ áƒ˜áƒ§áƒáƒ¡ Excel áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜áƒ¡ áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ¨áƒ˜ áƒáƒœ YYYY-MM-DD"],["â€¢ áƒ™áƒáƒ›áƒ‘áƒ˜áƒœáƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒáƒ—áƒáƒ®áƒ”áƒ‘áƒ˜ (áƒ›áƒáƒ’: 4022-4024) áƒáƒ•áƒ¢áƒáƒ›áƒáƒ¢áƒ£áƒ áƒáƒ“ áƒ“áƒáƒ˜áƒ§áƒáƒ¤áƒ"],["â€¢ áƒ¡áƒ˜áƒ¡áƒ¢áƒ”áƒ›áƒ áƒáƒ•áƒ¢áƒáƒ›áƒáƒ¢áƒ£áƒ áƒáƒ“ áƒ“áƒáƒ˜áƒ—áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒ•áƒ˜áƒ£áƒ  áƒ¨áƒ”áƒ›áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ‘áƒ¡ áƒáƒ áƒáƒáƒáƒ áƒªáƒ˜áƒ£áƒšáƒáƒ“"],[""],["ğŸ“Š áƒ—áƒ•áƒ˜áƒ£áƒ áƒ˜ áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜áƒ¡ áƒšáƒáƒ’áƒ˜áƒ™áƒ:"],["â€¢ áƒ—áƒ£ áƒ¯áƒáƒ•áƒ¨áƒáƒœáƒ˜ áƒ¡áƒ áƒ£áƒšáƒáƒ“ áƒ—áƒ•áƒ”áƒ¨áƒ˜ áƒáƒ áƒ˜áƒ¡ - áƒ§áƒ•áƒ”áƒšáƒ áƒ¦áƒáƒ›áƒ” áƒ“áƒ áƒ—áƒáƒœáƒ®áƒ áƒ˜áƒ—áƒ•áƒšáƒ”áƒ‘áƒ"],["â€¢ áƒ—áƒ£ áƒ¯áƒáƒ•áƒ¨áƒáƒœáƒ˜ áƒ—áƒ•áƒ”áƒ”áƒ‘áƒ¡ áƒ’áƒáƒ“áƒáƒ™áƒ•áƒ”áƒ—áƒ¡ - áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ™áƒáƒœáƒ™áƒ áƒ”áƒ¢áƒ£áƒšáƒ˜ áƒ—áƒ•áƒ˜áƒ¡ áƒ¦áƒáƒ›áƒ”áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒáƒ áƒáƒáƒáƒ áƒªáƒ˜áƒ£áƒšáƒ˜ áƒ—áƒáƒœáƒ®áƒ"],["â€¢ áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜: 28 áƒ›áƒáƒ áƒ¢áƒ˜áƒ“áƒáƒœ 5 áƒáƒáƒ áƒ˜áƒšáƒáƒ›áƒ“áƒ” â†’ áƒáƒáƒ áƒ˜áƒšáƒ¨áƒ˜ áƒ›áƒ®áƒáƒšáƒáƒ“ 5 áƒ¦áƒáƒ›áƒ”"],[""],["ğŸ“ áƒ¨áƒ”áƒœáƒáƒ®áƒ•áƒ:"],["â€¢ áƒ¨áƒ”áƒ˜áƒœáƒáƒ®áƒ”áƒ— .xlsx áƒáƒœ .xls áƒ¤áƒáƒ áƒ›áƒáƒ¢áƒ¨áƒ˜"],["â€¢ áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ›áƒáƒ¥áƒ¡áƒ˜áƒ›áƒáƒšáƒ£áƒ áƒ˜ áƒ–áƒáƒ›áƒ: 20MB"],[""],["Created by: Orbi City Management System"],["Version: 1.0"]],M=R.aoa_to_sheet(h);M["!cols"]=[{wch:40},{wch:60}],R.book_append_sheet(o,M,"áƒ˜áƒœáƒ¡áƒ¢áƒ áƒ£áƒ¥áƒªáƒ˜áƒ");const m=new Date,f=`OtelMS_Import_Template_${m.getFullYear()}-${String(m.getMonth()+1).padStart(2,"0")}-${String(m.getDate()).padStart(2,"0")}.xlsx`;Me(o,f)}function sn(){const s=["áƒœáƒáƒ›áƒ”áƒ áƒ˜ / Room","áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ / Check-in","áƒ’áƒáƒ¡áƒ•áƒšáƒ / Check-out","áƒ®áƒáƒœáƒ’áƒ áƒ«áƒšáƒ˜áƒ•áƒáƒ‘áƒ / Nights","áƒ—áƒáƒœáƒ®áƒ / Revenue","áƒ¬áƒ§áƒáƒ áƒ / Channel","áƒ‘áƒšáƒáƒ™áƒ˜ / Building"],n=R.book_new(),o=R.aoa_to_sheet([s]);o["!cols"]=[{wch:15},{wch:15},{wch:15},{wch:18},{wch:15},{wch:18},{wch:15}],R.book_append_sheet(n,o,"Bookings");const i=new Date,x=`OtelMS_Template_Empty_${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}.xlsx`;Me(n,x)}function cn(){const{toast:s}=fe(),[n,o]=u.useState(!1),[i,x]=u.useState(!1),[h,M]=u.useState(""),[m,f]=u.useState("date"),[g,F]=u.useState("desc"),[N,D]=u.useState(""),[k,d]=u.useState(""),[j,y]=u.useState(""),[b,l]=u.useState(""),{data:p,refetch:v}=ge({queryKey:["file-uploads-monthly"],queryFn:async()=>{const{data:{user:c}}=await w.auth.getUser();if(!c)throw new Error("User not authenticated");const{data:r,error:t}=await w.from("file_uploads").select("*").eq("user_id",c.id).eq("file_type","monthly_excel").order("created_at",{ascending:!1});if(t)throw t;return r}}),U=u.useMemo(()=>{if(!p||p.length===0)return{totalFiles:0,totalSize:0,latestUpload:null};const c=p.reduce((t,a)=>t+(a.file_size||0),0),r=[...p].sort((t,a)=>new Date(a.created_at).getTime()-new Date(t.created_at).getTime());return{totalFiles:p.length,totalSize:c,latestUpload:r[0]?.created_at||null}},[p]),S=u.useMemo(()=>{if(!p)return[];let c=[...p];if(h&&(c=c.filter(r=>r.file_name.toLowerCase().includes(h.toLowerCase()))),j&&(c=c.filter(r=>new Date(r.created_at)>=new Date(j))),b){const r=new Date(b);r.setHours(23,59,59,999),c=c.filter(t=>new Date(t.created_at)<=r)}if(N){const r=parseFloat(N)*1024;c=c.filter(t=>t.file_size>=r)}if(k){const r=parseFloat(k)*1024;c=c.filter(t=>t.file_size<=r)}return c.sort((r,t)=>{let a=0;switch(m){case"name":a=r.file_name.localeCompare(t.file_name);break;case"date":a=new Date(r.created_at).getTime()-new Date(t.created_at).getTime();break;case"size":a=r.file_size-t.file_size;break}return g==="asc"?a:-a}),c},[p,h,m,g,N,k,j,b]),H=()=>{M(""),D(""),d(""),y(""),l(""),f("date"),F("desc")},Q=async c=>{const r=c.target.files?.[0];if(!r)return;x(!0),s({title:"áƒ¨áƒ”áƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒ...",description:"Excel áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ•áƒáƒšáƒ˜áƒ“áƒáƒªáƒ˜áƒ áƒ›áƒ˜áƒ›áƒ“áƒ˜áƒœáƒáƒ áƒ”áƒáƒ‘áƒ¡"});const t=await nn(r);if(x(!1),!t.isValid){s({title:"âŒ áƒ•áƒáƒšáƒ˜áƒ“áƒáƒªáƒ˜áƒ áƒ•áƒ”áƒ  áƒ’áƒáƒ˜áƒáƒ áƒ",description:tn(t),variant:"destructive",duration:1e4}),c.target.value="";return}t.warnings.length>0?s({title:"âš ï¸ áƒ’áƒáƒ¤áƒ áƒ—áƒ®áƒ˜áƒšáƒ”áƒ‘áƒ”áƒ‘áƒ˜",description:t.warnings.join(`
`),duration:8e3}):s({title:"âœ… áƒ•áƒáƒšáƒ˜áƒ“áƒáƒªáƒ˜áƒ áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ£áƒšáƒ˜áƒ",description:"áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ¨áƒ”áƒ”áƒ¡áƒáƒ‘áƒáƒ›áƒ”áƒ‘áƒ áƒ›áƒáƒ—áƒ®áƒáƒ•áƒœáƒ”áƒ‘áƒ¡"}),o(!0);try{const{data:{user:a}}=await w.auth.getUser();if(!a)throw new Error("User not authenticated");const A=`${a.id}/${Date.now()}_${r.name}`,{error:C}=await w.storage.from("monthly-analysis").upload(A,r);if(C)throw C;const{error:L}=await w.from("file_uploads").insert({user_id:a.id,file_name:r.name,file_type:"monthly_excel",file_size:r.size,processing_status:"completed",metadata:{file_path:A,uploaded_at:new Date().toISOString()}});if(L)throw L;s({title:"âœ… áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ",description:"áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ— áƒáƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ"}),v(),c.target.value=""}catch(a){console.error("Upload error:",a),s({title:"áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",description:a.message||"áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ˜áƒ¡áƒáƒ¡ áƒ›áƒáƒ®áƒ“áƒ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",variant:"destructive"})}finally{o(!1)}},G=async(c,r)=>{if(!r){s({title:"áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",description:"áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ›áƒ˜áƒ¡áƒáƒ›áƒáƒ áƒ—áƒ˜ áƒ•áƒ”áƒ  áƒ›áƒáƒ˜áƒ«áƒ”áƒ‘áƒœáƒ",variant:"destructive"});return}try{const{error:t}=await w.storage.from("monthly-analysis").remove([r]);if(t)throw t;const{error:a}=await w.from("file_uploads").delete().eq("id",c);if(a)throw a;s({title:"âœ… áƒ¬áƒáƒ˜áƒ¨áƒáƒšáƒ",description:"áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ— áƒ¬áƒáƒ˜áƒ¨áƒáƒšáƒ"}),v()}catch(t){console.error("Delete error:",t),s({title:"áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",description:"áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ¬áƒáƒ¨áƒšáƒ˜áƒ¡áƒáƒ¡ áƒ›áƒáƒ®áƒ“áƒ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",variant:"destructive"})}},de=async(c,r)=>{try{const{data:t,error:a}=await w.storage.from("monthly-analysis").download(c);if(a)throw a;const A=window.URL.createObjectURL(t),C=document.createElement("a");C.href=A,C.download=r,document.body.appendChild(C),C.click(),document.body.removeChild(C),window.URL.revokeObjectURL(A),s({title:"âœ… áƒ©áƒáƒ›áƒáƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ",description:"áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ— áƒ©áƒáƒ›áƒáƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ"})}catch(t){console.error("Download error:",t),s({title:"áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",description:"áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ©áƒáƒ›áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ˜áƒ¡áƒáƒ¡ áƒ›áƒáƒ®áƒ“áƒ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",variant:"destructive"})}};return e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:317",className:"space-y-6",children:[e.jsxs(Pe,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:319",children:[e.jsx(ye,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:320",className:"h-4 w-4"}),e.jsx(Ke,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:321",children:"áƒ¡áƒáƒ­áƒ˜áƒ áƒ áƒ¡áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜ Excel áƒ¤áƒáƒ˜áƒšáƒ¨áƒ˜"}),e.jsx(He,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:322",children:e.jsxs("ul",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:323",className:"list-disc list-inside space-y-1 mt-2 text-sm",children:[e.jsxs("li",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:324",children:[e.jsx("strong",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:324",children:"áƒœáƒáƒ›áƒ”áƒ áƒ˜"})," / Room - áƒáƒ—áƒáƒ®áƒ˜áƒ¡ áƒœáƒáƒ›áƒ”áƒ áƒ˜"]}),e.jsxs("li",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:325",children:[e.jsx("strong",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:325",children:"áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ"})," / Check-in - áƒ¨áƒ”áƒ¡áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜"]}),e.jsxs("li",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:326",children:[e.jsx("strong",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:326",children:"áƒ’áƒáƒ¡áƒ•áƒšáƒ"})," / Check-out - áƒ’áƒáƒ¡áƒ•áƒšáƒ˜áƒ¡ áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜"]}),e.jsxs("li",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:327",children:[e.jsx("strong",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:327",children:"áƒ—áƒáƒœáƒ®áƒ"})," / Revenue - áƒ¯áƒáƒ•áƒ¨áƒœáƒ˜áƒ¡ áƒ—áƒáƒœáƒ®áƒ"]})]})})]}),e.jsx(E,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:332",className:"p-6",children:e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:333",className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:334",children:[e.jsx("h3",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:335",className:"text-lg font-semibold",children:"áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ— Excel áƒ¤áƒáƒ˜áƒšáƒ”áƒ‘áƒ˜"}),e.jsx("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:336",className:"text-sm text-muted-foreground",children:"áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ— OtelMS-áƒ“áƒáƒœ áƒ”áƒ¥áƒ¡áƒáƒáƒ áƒ¢áƒ˜áƒ áƒ”áƒ‘áƒ£áƒšáƒ˜ áƒ¤áƒáƒ˜áƒšáƒ”áƒ‘áƒ˜"})]}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:340",className:"flex gap-2",children:[e.jsxs(Oe,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:342",children:[e.jsx(qe,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:343",asChild:!0,children:e.jsxs(_,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:344",variant:"outline",children:[e.jsx(Fe,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:345",className:"h-4 w-4 mr-2"}),"Template"]})}),e.jsxs(Ve,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:349",align:"end",children:[e.jsxs(he,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:350",onClick:()=>{an(),s({title:"âœ… Template áƒ©áƒáƒ›áƒáƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ",description:"áƒœáƒ˜áƒ›áƒ£áƒ¨áƒ˜ áƒ¤áƒáƒ˜áƒšáƒ˜ áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ˜ áƒ›áƒáƒœáƒáƒªáƒ”áƒ›áƒ”áƒ‘áƒ˜áƒ—"})},children:[e.jsx(K,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:357",className:"h-4 w-4 mr-2"}),"áƒ›áƒáƒ’áƒáƒšáƒ˜áƒ—áƒ”áƒ‘áƒ˜áƒ—"]}),e.jsxs(he,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:360",onClick:()=>{sn(),s({title:"âœ… Template áƒ©áƒáƒ›áƒáƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ",description:"áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜ template áƒ›áƒ®áƒáƒšáƒáƒ“ áƒ¡áƒ•áƒ”áƒ¢áƒ”áƒ‘áƒ˜áƒ—"})},children:[e.jsx(je,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:367",className:"h-4 w-4 mr-2"}),"áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜"]})]})]}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:374",children:[e.jsx("input",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:375",type:"file",id:"excel-upload",accept:".xlsx,.xls",onChange:Q,className:"hidden",disabled:n||i}),e.jsxs(_,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:383",onClick:()=>document.getElementById("excel-upload")?.click(),disabled:n||i,children:[e.jsx(se,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:387",className:"h-4 w-4 mr-2"}),i?"áƒ˜áƒ›áƒáƒ¬áƒ›áƒ”áƒ‘áƒ...":n?"áƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ‘áƒ...":"áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ"]})]})]})]})}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:396",className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx(E,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:398",className:"p-6",children:e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:399",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:400",children:[e.jsx("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:401",className:"text-sm font-medium text-muted-foreground mb-1",children:"áƒ¡áƒ£áƒš áƒ¤áƒáƒ˜áƒšáƒ”áƒ‘áƒ˜"}),e.jsx("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:402",className:"text-3xl font-bold text-foreground",children:U.totalFiles})]}),e.jsx("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:404",className:"h-12 w-12 rounded-full bg-primary/10 flex items-center justify-center",children:e.jsx(ve,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:405",className:"h-6 w-6 text-primary"})})]})}),e.jsx(E,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:411",className:"p-6",children:e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:412",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:413",children:[e.jsx("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:414",className:"text-sm font-medium text-muted-foreground mb-1",children:"áƒ¯áƒáƒ›áƒ£áƒ áƒ˜ áƒ–áƒáƒ›áƒ"}),e.jsxs("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:415",className:"text-3xl font-bold text-foreground",children:[(U.totalSize/(1024*1024)).toFixed(2)," MB"]})]}),e.jsx("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:419",className:"h-12 w-12 rounded-full bg-blue-500/10 flex items-center justify-center",children:e.jsx(we,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:420",className:"h-6 w-6 text-blue-500"})})]})}),e.jsx(E,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:426",className:"p-6",children:e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:427",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:428",children:[e.jsx("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:429",className:"text-sm font-medium text-muted-foreground mb-1",children:"áƒ‘áƒáƒšáƒ áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ"}),e.jsx("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:430",className:"text-lg font-bold text-foreground",children:U.latestUpload?te(new Date(U.latestUpload),"dd MMM yyyy",{locale:ae}):"áƒáƒ  áƒáƒ áƒ˜áƒ¡"}),U.latestUpload&&e.jsx("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:436",className:"text-xs text-muted-foreground mt-1",children:te(new Date(U.latestUpload),"HH:mm",{locale:ae})})]}),e.jsx("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:441",className:"h-12 w-12 rounded-full bg-green-500/10 flex items-center justify-center",children:e.jsx(Ne,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:442",className:"h-6 w-6 text-green-500"})})]})})]}),e.jsx(E,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:449",className:"p-6",children:e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:450",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:451",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:452",className:"flex items-center gap-2",children:[e.jsx(be,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:453",className:"h-4 w-4 text-muted-foreground"}),e.jsx("h3",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:454",className:"font-semibold",children:"áƒ¤áƒ˜áƒšáƒ¢áƒ áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒ«áƒ”áƒ‘áƒœáƒ"})]}),e.jsx(_,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:456",variant:"ghost",size:"sm",onClick:H,children:"áƒ’áƒáƒ¡áƒ£áƒ¤áƒ—áƒáƒ•áƒ”áƒ‘áƒ"})]}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:466",className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:468",className:"space-y-2",children:[e.jsx(B,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:469",children:"áƒ«áƒ”áƒ‘áƒœáƒ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜áƒ—"}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:470",className:"relative",children:[e.jsx(Ue,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:471",className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(T,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:472",placeholder:"áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒ¡áƒáƒ®áƒ”áƒšáƒ˜...",value:h,onChange:c=>M(c.target.value),className:"pl-10"})]})]}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:482",className:"space-y-2",children:[e.jsx(B,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:483",children:"áƒ“áƒáƒšáƒáƒ’áƒ”áƒ‘áƒ"}),e.jsxs(le,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:484",value:m,onValueChange:c=>f(c),children:[e.jsx(oe,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:485",children:e.jsx(ie,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:486"})}),e.jsxs(re,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:488",children:[e.jsx(I,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:489",value:"date",children:"áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜áƒ—"}),e.jsx(I,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:490",value:"name",children:"áƒ¡áƒáƒ®áƒ”áƒšáƒ˜áƒ—"}),e.jsx(I,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:491",value:"size",children:"áƒ–áƒáƒ›áƒ˜áƒ—"})]})]})]}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:497",className:"space-y-2",children:[e.jsx(B,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:498",children:"áƒ›áƒ˜áƒ›áƒáƒ áƒ—áƒ£áƒšáƒ”áƒ‘áƒ"}),e.jsx(_,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:499",variant:"outline",className:"w-full justify-start",onClick:()=>F(g==="asc"?"desc":"asc"),children:g==="asc"?e.jsxs(e.Fragment,{children:[e.jsx(Re,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:506",className:"h-4 w-4 mr-2"}),"áƒ–áƒ áƒ“áƒáƒ“áƒáƒ‘áƒ˜áƒ—"]}):e.jsxs(e.Fragment,{children:[e.jsx(ke,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:511",className:"h-4 w-4 mr-2"}),"áƒ™áƒšáƒ”áƒ‘áƒáƒ“áƒáƒ‘áƒ˜áƒ—"]})})]})]}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:520",className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-2 border-t",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:522",className:"space-y-2",children:[e.jsx(B,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:523",children:"áƒ—áƒáƒ áƒ˜áƒ¦áƒ˜áƒ¡ áƒ“áƒ˜áƒáƒáƒáƒ–áƒáƒœáƒ˜"}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:524",className:"grid grid-cols-2 gap-2",children:[e.jsx(T,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:525",type:"date",value:j,onChange:c=>y(c.target.value),placeholder:"áƒ“áƒáƒœ"}),e.jsx(T,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:531",type:"date",value:b,onChange:c=>l(c.target.value),placeholder:"áƒ›áƒ“áƒ”"})]})]}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:541",className:"space-y-2",children:[e.jsx(B,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:542",children:"áƒ–áƒáƒ›áƒ (KB)"}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:543",className:"grid grid-cols-2 gap-2",children:[e.jsx(T,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:544",type:"number",value:N,onChange:c=>D(c.target.value),placeholder:"áƒ›áƒ˜áƒœ",min:"0"}),e.jsx(T,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:551",type:"number",value:k,onChange:c=>d(c.target.value),placeholder:"áƒ›áƒáƒ¥áƒ¡",min:"0"})]})]})]}),e.jsx("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:563",className:"flex items-center justify-between pt-2 border-t",children:e.jsxs("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:564",className:"text-sm text-muted-foreground",children:["áƒœáƒáƒáƒáƒ•áƒœáƒ˜áƒ: ",e.jsx("span",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:565",className:"font-semibold text-foreground",children:S?.length||0})," áƒ¤áƒáƒ˜áƒšáƒ˜",p&&S&&S.length!==p.length&&e.jsxs("span",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:567",className:"ml-1",children:["(",p.length," áƒ¡áƒ£áƒš)"]})]})})]})}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:575",className:"space-y-3",children:[S&&S.length===0&&e.jsx(E,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:577",className:"p-8",children:e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:578",className:"flex flex-col items-center justify-center text-center space-y-2",children:[e.jsx(K,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:579",className:"h-12 w-12 text-muted-foreground"}),e.jsx("h3",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:580",className:"text-lg font-medium",children:"áƒ¤áƒáƒ˜áƒšáƒ”áƒ‘áƒ˜ áƒªáƒáƒ áƒ˜áƒ”áƒšáƒ˜áƒ"}),e.jsx("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:581",className:"text-sm text-muted-foreground",children:"áƒ¯áƒ”áƒ  áƒáƒ  áƒáƒ áƒ˜áƒ¡ áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ£áƒšáƒ˜ Excel áƒ¤áƒáƒ˜áƒšáƒ”áƒ‘áƒ˜"})]})}),S?.map(c=>{const r=typeof c.metadata=="object"&&c.metadata!==null?c.metadata.file_path:null;return e.jsx(E,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:593",className:"p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:594",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:595",className:"flex items-center gap-4 flex-1",children:[e.jsx("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:596",className:"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-blue-500 to-cyan-500",children:e.jsx(K,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:597",className:"h-5 w-5 text-white"})}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:599",className:"flex-1",children:[e.jsx("h4",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:600",className:"font-medium text-sm",children:c.file_name}),e.jsxs("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:601",className:"text-xs text-muted-foreground",children:[e.jsx(ce,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:602",className:"h-3 w-3 inline mr-1"}),te(new Date(c.created_at),"PPp",{locale:ae})]}),e.jsxs("p",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:605",className:"text-xs text-muted-foreground",children:["áƒ–áƒáƒ›áƒ: ",(c.file_size/1024).toFixed(2)," KB"]})]})]}),e.jsxs("div",{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:610",className:"flex items-center gap-2",children:[e.jsx(_,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:611",variant:"ghost",size:"sm",onClick:()=>r&&de(r,c.file_name),disabled:!r,children:e.jsx(Se,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:617",className:"h-4 w-4"})}),e.jsx(_,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:619",variant:"ghost",size:"sm",onClick:()=>G(c.id,r),children:e.jsx(Ce,{"data-loc":"client/src/components/finance/MonthlyFileUploadManager.tsx:624",className:"h-4 w-4 text-destructive"})})]})]})},c.id)})]})]})}const xe=[{value:"1",label:"áƒ˜áƒáƒœáƒ•áƒáƒ áƒ˜"},{value:"2",label:"áƒ—áƒ”áƒ‘áƒ”áƒ áƒ•áƒáƒšáƒ˜"},{value:"3",label:"áƒ›áƒáƒ áƒ¢áƒ˜"},{value:"4",label:"áƒáƒáƒ áƒ˜áƒšáƒ˜"},{value:"5",label:"áƒ›áƒáƒ˜áƒ¡áƒ˜"},{value:"6",label:"áƒ˜áƒ•áƒœáƒ˜áƒ¡áƒ˜"},{value:"7",label:"áƒ˜áƒ•áƒšáƒ˜áƒ¡áƒ˜"},{value:"8",label:"áƒáƒ’áƒ•áƒ˜áƒ¡áƒ¢áƒ"},{value:"9",label:"áƒ¡áƒ”áƒ¥áƒ¢áƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜"},{value:"10",label:"áƒáƒ¥áƒ¢áƒáƒ›áƒ‘áƒ”áƒ áƒ˜"},{value:"11",label:"áƒœáƒáƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜"},{value:"12",label:"áƒ“áƒ”áƒ™áƒ”áƒ›áƒ‘áƒ”áƒ áƒ˜"}],Mn=()=>{_e();const{toast:s}=fe(),[n,o]=u.useState(!1),[i,x]=u.useState(null),[h,M]=u.useState(""),[m,f]=u.useState(""),[g,F]=u.useState(!1),{data:N,isLoading:D,refetch:k}=ge({queryKey:["monthly-analysis-uploads"],queryFn:async()=>{const{data:{user:l}}=await w.auth.getUser();if(!l)throw new Error("User not authenticated");const{data:p,error:v}=await w.from("monthly_analysis_uploads").select("*").eq("user_id",l.id).order("year",{ascending:!1}).order("month",{ascending:!1});if(v)throw v;return p}}),d=l=>{l.target.files&&l.target.files[0]&&x(l.target.files[0])},j=async()=>{if(!i||!h||!m){s({title:"áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",description:"áƒ’áƒ—áƒ®áƒáƒ•áƒ— áƒ¨áƒ”áƒáƒ•áƒ¡áƒáƒ— áƒ§áƒ•áƒ”áƒšáƒ áƒ•áƒ”áƒšáƒ˜ áƒ“áƒ áƒáƒ˜áƒ áƒ©áƒ˜áƒáƒ— áƒ¤áƒáƒ˜áƒšáƒ˜",variant:"destructive"});return}F(!0);try{const{data:{user:l}}=await w.auth.getUser();if(!l)throw new Error("User not authenticated");const p=await Je(i,parseInt(m),parseInt(h)),v=`${l.id}/${m}-${h.padStart(2,"0")}-${i.name}`,{error:U}=await w.storage.from("monthly-analysis").upload(v,i,{upsert:!0});if(U)throw U;const{error:S}=await w.from("monthly_analysis_uploads").insert({user_id:l.id,month:parseInt(h),year:parseInt(m),file_name:i.name,file_path:v,total_revenue:p.overallStats.totalRevenue,total_expenses:0,net_profit:p.overallStats.totalRevenue,profit_margin:0,occupancy_rate:p.overallStats.occupancyRate,adr:p.overallStats.avgADR,revpar:p.overallStats.revPAR,total_nights:p.overallStats.totalNights,total_bookings:p.overallStats.totalBookings,total_rooms:p.overallStats.uniqueRooms});if(S)throw S;s({title:"áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ",description:"áƒ—áƒ•áƒ˜áƒ£áƒ áƒ˜ áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜ áƒ¬áƒáƒ áƒ›áƒáƒ¢áƒ”áƒ‘áƒ˜áƒ— áƒáƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ"}),o(!1),x(null),M(""),f(""),k()}catch(l){console.error("Upload error:",l),s({title:"áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",description:"áƒ¤áƒáƒ˜áƒšáƒ˜áƒ¡ áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ˜áƒ¡áƒáƒ¡ áƒ›áƒáƒ®áƒ“áƒ áƒ¨áƒ”áƒªáƒ“áƒáƒ›áƒ",variant:"destructive"})}finally{F(!1)}},y=new Date().getFullYear(),b=Array.from({length:5},(l,p)=>y-p);return e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:137",className:"min-h-screen bg-background",children:[e.jsx("header",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:138",className:"border-b border-border bg-card/50 backdrop-blur-sm sticky top-0 z-50",children:e.jsx("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:139",className:"container mx-auto px-6 py-4",children:e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:140",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:141",className:"flex items-center gap-4",children:[e.jsxs(_,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:142",variant:"ghost",size:"sm",onClick:()=>setLocation("/finance"),children:[e.jsx(De,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:143",className:"h-4 w-4 mr-2"}),"áƒ£áƒ™áƒáƒœ"]}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:146",className:"flex items-center gap-3",children:[e.jsx("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:147",className:"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-green-500 to-emerald-500",children:e.jsx(ce,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:148",className:"h-6 w-6 text-white"})}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:150",children:[e.jsx("h1",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:151",className:"text-xl font-bold text-foreground",children:"áƒ—áƒ•áƒ”áƒ”áƒ‘áƒ˜áƒ¡ áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜"}),e.jsx("p",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:152",className:"text-xs text-muted-foreground",children:"áƒ—áƒ•áƒ˜áƒ£áƒ áƒ˜ áƒ¤áƒ˜áƒœáƒáƒœáƒ¡áƒ£áƒ áƒ˜ áƒ áƒ”áƒáƒáƒ áƒ¢áƒ”áƒ‘áƒ˜ áƒ“áƒ áƒáƒœáƒáƒšáƒ˜áƒ¢áƒ˜áƒ™áƒ"})]})]})]}),e.jsxs(ze,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:159",open:n,onOpenChange:o,children:[e.jsx(Le,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:160",asChild:!0,children:e.jsxs(_,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:161",className:"gap-2",children:[e.jsx(pe,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:162",className:"h-4 w-4"}),"áƒáƒ®áƒáƒšáƒ˜ áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜"]})}),e.jsxs(Te,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:166",children:[e.jsx($e,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:167",children:e.jsx(Ie,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:168",children:"áƒ—áƒ•áƒ˜áƒ£áƒ áƒ˜ áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜áƒ¡ áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ"})}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:170",className:"space-y-4 pt-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:171",className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:172",className:"space-y-2",children:[e.jsx(B,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:173",children:"áƒ—áƒ•áƒ”"}),e.jsxs(le,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:174",value:h,onValueChange:M,children:[e.jsx(oe,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:175",children:e.jsx(ie,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:176",placeholder:"áƒáƒ˜áƒ áƒ©áƒ˜áƒ”áƒ— áƒ—áƒ•áƒ”"})}),e.jsx(re,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:178",children:xe.map(l=>e.jsx(I,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:180",value:l.value,children:l.label},l.value))})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:187",className:"space-y-2",children:[e.jsx(B,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:188",children:"áƒ¬áƒ”áƒšáƒ˜"}),e.jsxs(le,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:189",value:m,onValueChange:f,children:[e.jsx(oe,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:190",children:e.jsx(ie,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:191",placeholder:"áƒáƒ˜áƒ áƒ©áƒ˜áƒ”áƒ— áƒ¬áƒ”áƒšáƒ˜"})}),e.jsx(re,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:193",children:b.map(l=>e.jsx(I,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:195",value:l.toString(),children:l},l))})]})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:204",className:"space-y-2",children:[e.jsx(B,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:205",htmlFor:"file",children:"Excel áƒ¤áƒáƒ˜áƒšáƒ˜"}),e.jsx(T,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:206",id:"file",type:"file",accept:".xlsx,.xls",onChange:d}),i&&e.jsxs("p",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:213",className:"text-xs text-muted-foreground",children:["áƒáƒ áƒ©áƒ”áƒ£áƒšáƒ˜ áƒ¤áƒáƒ˜áƒšáƒ˜: ",i.name]})]}),e.jsxs(_,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:219",onClick:j,disabled:g||!i||!h||!m,className:"w-full",children:[e.jsx(se,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:224",className:"h-4 w-4 mr-2"}),g?"áƒ˜áƒ¢áƒ•áƒ˜áƒ áƒ—áƒ”áƒ‘áƒ...":"áƒáƒ¢áƒ•áƒ˜áƒ áƒ—áƒ•áƒ"]})]})]})]})]})})}),e.jsxs("main",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:234",className:"container mx-auto px-6 py-8",children:[e.jsx("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:235",className:"mb-8",children:e.jsx(cn,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:236"})}),D?e.jsx("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:240",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map(l=>e.jsx(Ye,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:242",className:"h-[200px]"},l))}):N&&N.length>0?e.jsx("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:246",className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:N.map(l=>e.jsxs(E,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:248",className:"group p-6 hover:shadow-lg transition-all cursor-pointer border-2 hover:border-primary/50",onClick:()=>setLocation(`/finance/monthly-analysis/${l.year}/${l.month}`),children:[e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:253",className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:254",className:"flex items-center gap-3",children:[e.jsx("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:255",className:"flex h-12 w-12 items-center justify-center rounded-lg bg-gradient-to-br from-green-500 to-emerald-500",children:e.jsx(ce,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:256",className:"h-6 w-6 text-white"})}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:258",children:[e.jsx("h3",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:259",className:"font-bold text-lg",children:xe.find(p=>p.value===l.month.toString())?.label}),e.jsx("p",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:262",className:"text-sm text-muted-foreground",children:l.year})]})]}),e.jsx(Ee,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:265",className:"h-5 w-5 text-muted-foreground group-hover:text-primary transition-colors"})]}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:268",className:"space-y-3",children:[e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:269",className:"flex items-center justify-between p-3 bg-accent/50 rounded-lg",children:[e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:270",className:"flex items-center gap-2",children:[e.jsx(Ae,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:271",className:"h-4 w-4 text-green-600"}),e.jsx("span",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:272",className:"text-sm text-muted-foreground",children:"áƒ¨áƒ”áƒ›áƒáƒ¡áƒáƒ•áƒáƒšáƒ˜"})]}),e.jsxs("span",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:274",className:"font-bold text-lg",children:["â‚¾",l.total_revenue?.toLocaleString()]})]}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:277",className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:278",className:"p-3 bg-accent/30 rounded-lg",children:[e.jsx("p",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:279",className:"text-xs text-muted-foreground mb-1",children:"áƒ“áƒáƒ™áƒáƒ•áƒ”áƒ‘áƒ"}),e.jsxs("p",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:280",className:"font-semibold",children:[l.occupancy_rate?.toFixed(1),"%"]})]}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:282",className:"p-3 bg-accent/30 rounded-lg",children:[e.jsx("p",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:283",className:"text-xs text-muted-foreground mb-1",children:"ADR"}),e.jsxs("p",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:284",className:"font-semibold",children:["â‚¾",l.adr?.toFixed(0)]})]})]}),l.ai_summary_ka&&e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:289",className:"flex items-center gap-2 px-3 py-2 bg-primary/10 rounded-lg",children:[e.jsx(Be,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:290",className:"h-4 w-4 text-primary"}),e.jsx("span",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:291",className:"text-xs font-medium text-primary",children:"AI áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜ áƒ›áƒ–áƒáƒ“áƒáƒ"})]}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:295",className:"flex items-center gap-2 text-xs text-muted-foreground pt-2 border-t border-border/50",children:[e.jsx(K,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:296",className:"h-3 w-3"}),e.jsx("span",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:297",className:"truncate",children:l.file_name})]})]})]},l.id))}):e.jsx(E,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:304",className:"p-8",children:e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:305",className:"flex flex-col items-center justify-center space-y-6 text-center min-h-[400px]",children:[e.jsx("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:306",className:"flex h-20 w-20 items-center justify-center rounded-full bg-gradient-to-br from-green-500 to-emerald-500",children:e.jsx(se,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:307",className:"h-10 w-10 text-white"})}),e.jsxs("div",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:309",children:[e.jsx("h2",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:310",className:"text-2xl font-bold text-foreground mb-2",children:"áƒ—áƒ•áƒ˜áƒ£áƒ áƒ˜ áƒ áƒ”áƒáƒáƒ áƒ¢áƒ”áƒ‘áƒ˜"}),e.jsx("p",{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:313",className:"text-muted-foreground max-w-md",children:"áƒáƒ¥ áƒœáƒáƒ®áƒáƒ•áƒ— áƒ“áƒ”áƒ¢áƒáƒšáƒ£áƒ  áƒ—áƒ•áƒ˜áƒ£áƒ  áƒáƒœáƒáƒšáƒ˜áƒ–áƒ¡ - áƒ¨áƒ”áƒ›áƒáƒ¡áƒáƒ•áƒšáƒ”áƒ‘áƒ˜, áƒ®áƒáƒ áƒ¯áƒ”áƒ‘áƒ˜, áƒ“áƒáƒ™áƒáƒ•áƒ”áƒ‘áƒ, ADR áƒ“áƒ áƒ¡áƒ®áƒ•áƒ áƒ›áƒœáƒ˜áƒ¨áƒ•áƒœáƒ”áƒšáƒáƒ•áƒáƒœáƒ˜ áƒ›áƒ”áƒ¢áƒ áƒ˜áƒ™áƒ”áƒ‘áƒ˜ áƒ—áƒ•áƒ”áƒ”áƒ‘áƒ˜áƒ¡ áƒ›áƒ˜áƒ®áƒ”áƒ“áƒ•áƒ˜áƒ—"})]}),e.jsxs(_,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:318",onClick:()=>o(!0),className:"gap-2",children:[e.jsx(pe,{"data-loc":"client/src/pages/finance/FinanceMonthlyReports.tsx:319",className:"h-4 w-4"}),"áƒáƒ˜áƒ áƒ•áƒ”áƒšáƒ˜ áƒáƒœáƒáƒšáƒ˜áƒ–áƒ˜áƒ¡ áƒ“áƒáƒ›áƒáƒ¢áƒ”áƒ‘áƒ"]})]})})]})]})};export{Mn as default};
