import{j as e,aT as R,aU as V,aV as q,r as d,u as K,a6 as i,m as k,aE as _,a1 as S,at as O,$ as M,aW as W,aS as H,e as J,i as X,l as Y,aD as Z}from"./react-vendor-BIDRRw8F.js";import{j as ee,t as c,B as t,C as x}from"./index-BLcOQO7i.js";import{I as se}from"./input-BuEOZAZD.js";import{B as $}from"./badge-BATP3r_Y.js";import{T as ae,a as te,b as o,c as re}from"./tabs-D52QQNv5.js";import{S as ie,a as le,b as ne,c as ce,d as m}from"./select-ANAJPCoK.js";import"./trpc-vendor-wm-eNDph.js";import"./vendor-INCMKllo.js";function oe({className:r,...b}){return e.jsx(R,{"data-loc":"client/src/components/ui/checkbox.tsx:12","data-slot":"checkbox",className:ee("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",r),...b,children:e.jsx(V,{"data-loc":"client/src/components/ui/checkbox.tsx:20","data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:e.jsx(q,{"data-loc":"client/src/components/ui/checkbox.tsx:24",className:"size-3.5"})})})}const de={bookings:Z,finance:Y,marketing:X,spam:J,important:H,general:W},A={bookings:"bg-blue-500/10 text-blue-600 border-blue-500/20",finance:"bg-green-500/10 text-green-600 border-green-500/20",marketing:"bg-purple-500/10 text-purple-600 border-purple-500/20",spam:"bg-red-500/10 text-red-600 border-red-500/20",important:"bg-yellow-500/10 text-yellow-600 border-yellow-500/20",general:"bg-gray-500/10 text-gray-600 border-gray-500/20"};function ye(){const[r,b]=d.useState("all"),[v,T]=d.useState(""),[xe,me]=d.useState(null),[w,h]=d.useState(!1),[,U]=K(),[l,I]=d.useState(new Set),[n,E]=d.useState(!1),{data:g,isLoading:B,refetch:j}=c.emailCategorization.getCategorizedEmails.useQuery({category:r==="all"?void 0:r,limit:50,offset:0}),{data:C}=c.emailCategorization.getCategoryStats.useQuery(),{data:y}=c.emailCategorization.getUnsubscribeSuggestions.useQuery({status:"suggested",limit:20}),f=c.emailCategorization.searchEmails.useMutation(),P=c.emailCategorization.syncGmailEmails.useMutation({onSuccess:s=>{i.success(s.message),j(),h(!1)},onError:()=>{i.error("Gmail sync failed"),h(!1)}}),{data:ge}=c.emailCategorization.getGmailSyncStatus.useQuery(),p=c.emailCategorization.updateUnsubscribeStatus.useMutation({onSuccess:()=>{i.success("Unsubscribe status updated"),j()}}),z=async()=>{if(!v.trim()){i.error("Please enter a search query");return}try{const s=await f.mutateAsync({query:v});i.success(`Found ${s.total} emails`)}catch{i.error("Search failed")}},N=(s,a)=>{p.mutate({id:s,status:a})},D=s=>{const a=new Set(l);a.has(s)?a.delete(s):a.add(s),I(a)},G=()=>{if(g){const s=new Set(g.emails.map(a=>a.emailId));I(s)}},u=()=>{I(new Set)},L=s=>{i.success(`Categorizing ${l.size} emails as ${s}...`),u(),E(!1)},Q=()=>{i.success(`Deleting ${l.size} emails...`),u(),E(!1)};return e.jsx("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:163",className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-purple-50 p-6",children:e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:164",className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:166",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:167",children:[e.jsxs("h1",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:168",className:"text-3xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(k,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:169",className:"w-8 h-8 text-blue-600"}),"Email Inbox"]}),e.jsx("p",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:172",className:"text-gray-600 mt-1",children:"AI-powered email management with smart categorization"})]}),e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:174",className:"flex gap-2",children:[e.jsxs(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:175",onClick:()=>j(),variant:"outline",size:"sm",children:[e.jsx(_,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:176",className:"w-4 h-4 mr-2"}),"Refresh"]}),e.jsxs(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:179",onClick:()=>{h(!0),P.mutate({query:"newer_than:7d",maxResults:50})},variant:"default",size:"sm",disabled:w,children:[w?e.jsx(S,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:189",className:"w-4 h-4 mr-2 animate-spin"}):e.jsx(k,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:191",className:"w-4 h-4 mr-2"}),"Sync Gmail"]}),e.jsx(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:195",onClick:()=>{E(!n),n&&u()},variant:n?"default":"outline",size:"sm",children:n?"Cancel Selection":"Select Multiple"})]})]}),e.jsx(x,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:209",className:"p-4 bg-white/80 backdrop-blur-sm border border-gray-200",children:e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:210",className:"flex gap-2",children:[e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:211",className:"relative flex-1",children:[e.jsx(O,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:212",className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx(se,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:213",type:"text",placeholder:"Natural language search (e.g., 'find booking emails from last week')",value:v,onChange:s=>T(s.target.value),onKeyDown:s=>s.key==="Enter"&&z(),className:"pl-10"})]}),e.jsxs(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:222",onClick:z,disabled:f.isPending,children:[f.isPending?e.jsx(S,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:224",className:"w-4 h-4 animate-spin"}):e.jsx(M,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:226",className:"w-4 h-4 mr-2"}),"AI Search"]})]})}),C&&e.jsx("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:235",className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:C.stats.map(s=>{const a=de[s.category],F=A[s.category];return e.jsxs(x,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:241",className:`p-4 cursor-pointer transition-all hover:scale-105 ${r===s.category?"ring-2 ring-blue-500":""} ${F}`,onClick:()=>b(s.category),children:[e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:248",className:"flex items-center gap-2 mb-2",children:[e.jsx(a,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:249",className:"w-5 h-5"}),e.jsx("span",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:250",className:"font-semibold capitalize",children:s.category})]}),e.jsx("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:252",className:"text-2xl font-bold",children:Number(s.count)}),e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:253",className:"text-sm opacity-70",children:[Math.round(Number(s.avgConfidence)),"% confidence"]})]},s.category)})}),e.jsxs(ae,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:263",value:r,onValueChange:s=>b(s),className:"space-y-4",children:[e.jsxs(te,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:264",className:"bg-white/80 backdrop-blur-sm border border-gray-200",children:[e.jsx(o,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:265",value:"all",children:"All Emails"}),e.jsx(o,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:266",value:"bookings",children:"Bookings"}),e.jsx(o,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:267",value:"finance",children:"Finance"}),e.jsx(o,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:268",value:"marketing",children:"Marketing"}),e.jsx(o,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:269",value:"important",children:"Important"}),e.jsx(o,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:270",value:"spam",children:"Spam"}),e.jsx(o,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:271",value:"general",children:"General"})]}),e.jsx(re,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:274",value:r,className:"space-y-4",children:B?e.jsx("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:276",className:"flex items-center justify-center py-12",children:e.jsx(S,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:277",className:"w-8 h-8 animate-spin text-blue-600"})}):g&&g.emails.length>0?e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:280",className:"space-y-4",children:[n&&l.size>0&&e.jsx(x,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:283",className:"p-4 bg-gradient-to-r from-blue-50 to-purple-50 border border-blue-200",children:e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:284",className:"flex items-center justify-between gap-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:285",className:"flex items-center gap-4",children:[e.jsxs("span",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:286",className:"font-semibold text-gray-900",children:[l.size," selected"]}),e.jsx(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:289",size:"sm",variant:"outline",onClick:G,children:"Select All"}),e.jsx(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:292",size:"sm",variant:"outline",onClick:u,children:"Deselect All"})]}),e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:296",className:"flex items-center gap-2",children:[e.jsxs(ie,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:297",onValueChange:s=>L(s),children:[e.jsx(le,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:298",className:"w-48",children:e.jsx(ne,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:299",placeholder:"Categorize as..."})}),e.jsxs(ce,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:301",children:[e.jsx(m,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:302",value:"bookings",children:"Bookings"}),e.jsx(m,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:303",value:"finance",children:"Finance"}),e.jsx(m,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:304",value:"marketing",children:"Marketing"}),e.jsx(m,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:305",value:"spam",children:"Spam"}),e.jsx(m,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:306",value:"important",children:"Important"}),e.jsx(m,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:307",value:"general",children:"General"})]})]}),e.jsx(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:310",size:"sm",variant:"destructive",onClick:Q,children:"Delete"})]})]})}),e.jsx("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:317",className:"space-y-2",children:g.emails.map(s=>e.jsx(x,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:319",className:`p-4 bg-white/80 backdrop-blur-sm border border-gray-200 hover:shadow-lg transition-all cursor-pointer ${l.has(s.emailId)?"ring-2 ring-blue-500":""}`,onClick:a=>{n?(a.stopPropagation(),D(s.emailId)):U(`/email-inbox/${s.emailId}`)},children:e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:333",className:"flex items-start justify-between gap-4",children:[n&&e.jsx(oe,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:335",checked:l.has(s.emailId),onCheckedChange:()=>D(s.emailId),onClick:a=>a.stopPropagation()}),e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:341",className:"flex-1 min-w-0",children:[e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:342",className:"flex items-center gap-2 mb-1",children:[e.jsx($,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:343",className:A[s.category],children:s.category}),e.jsx("span",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:346",className:"text-sm text-gray-600 truncate",children:s.emailFrom}),e.jsx("span",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:347",className:"text-xs text-gray-400",children:s.emailDate?new Date(s.emailDate).toLocaleDateString():"Unknown"})]}),e.jsx("h3",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:351",className:"font-semibold text-gray-900 truncate",children:s.emailSubject}),e.jsx("p",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:352",className:"text-sm text-gray-600 mt-1 line-clamp-1",children:s.aiReasoning})]}),e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:354",className:"flex flex-col items-end gap-1",children:[e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:355",className:"text-xs text-gray-500",children:[s.confidence,"% confident"]}),s.manuallyOverridden&&e.jsx($,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:357",variant:"outline",className:"text-xs",children:"Manual"})]})]})},s.id))})]}):e.jsxs(x,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:366",className:"p-12 bg-white/80 backdrop-blur-sm border border-gray-200 text-center",children:[e.jsx(k,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:367",className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:368",className:"text-lg font-semibold text-gray-900 mb-2",children:"No emails found"}),e.jsx("p",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:369",className:"text-gray-600",children:r==="all"?"No emails have been categorized yet.":`No ${r} emails found.`})]})})]}),y&&y.suggestions.length>0&&e.jsxs(x,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:381",className:"p-6 bg-gradient-to-r from-purple-50 to-pink-50 border border-purple-200",children:[e.jsxs("h2",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:382",className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(M,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:383",className:"w-5 h-5 text-purple-600"}),"Smart Unsubscribe Suggestions"]}),e.jsx("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:386",className:"space-y-3",children:y.suggestions.slice(0,5).map(s=>e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:388",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-purple-200",children:[e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:392",className:"flex-1 min-w-0",children:[e.jsx("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:393",className:"font-semibold text-gray-900 truncate",children:s.emailFrom}),e.jsx("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:394",className:"text-sm text-gray-600 truncate",children:s.emailSubject}),e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:395",className:"text-xs text-gray-500 mt-1",children:[s.senderEmailCount," emails â€¢ ",s.detectionMethod.replace("_"," ")]})]}),e.jsxs("div",{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:399",className:"flex gap-2",children:[e.jsx(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:400",size:"sm",variant:"outline",onClick:()=>N(s.id,"dismissed"),disabled:p.isPending,children:"Dismiss"}),e.jsx(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:408",size:"sm",variant:"outline",onClick:()=>N(s.id,"kept"),disabled:p.isPending,children:"Keep"}),e.jsx(t,{"data-loc":"client/src/pages/reservations/EmailInbox.tsx:416",size:"sm",onClick:()=>N(s.id,"unsubscribed"),disabled:p.isPending,className:"bg-purple-600 hover:bg-purple-700 text-white",children:"Unsubscribe"})]})]},s.id))})]})]})})}export{ye as default};
