import{r as _,a6 as m,j as s,aL as P,ar as B,a_ as L,$ as v,i as G,am as h,b2 as Q,a5 as $}from"./react-vendor-BIDRRw8F.js";import{t as i,C as t,b as o,c as r,a,d as j,T as D,B as x}from"./index-BLcOQO7i.js";import{B as A}from"./badge-BATP3r_Y.js";import{T as O,a as U,b as N,c as f}from"./tabs-D52QQNv5.js";import"./trpc-vendor-wm-eNDph.js";import"./vendor-INCMKllo.js";function K(){const[b,p]=_.useState(null),[g,y]=_.useState(""),{data:d,refetch:C}=i.butler.getPendingTasks.useQuery(),{data:u}=i.butler.getReviews.useQuery({withoutResponseOnly:!0}),{data:n}=i.butler.getMetrics.useQuery({days:30}),{data:l}=i.butler.getRecommendations.useQuery(),{data:w}=i.butler.getStats.useQuery({days:30}),R=i.butler.approve.useMutation({onSuccess:()=>{m.success("Task approved successfully!"),C(),p(null),y("")},onError:e=>{m.error(`Failed to approve: ${e.message}`)}}),k=i.butler.reject.useMutation({onSuccess:()=>{m.success("Task rejected"),C(),p(null)},onError:e=>{m.error(`Failed to reject: ${e.message}`)}}),S=i.butler.generateResponse.useMutation({onSuccess:()=>{m.success("AI response generated! Check Pending Tasks tab."),C()},onError:e=>{m.error(`Failed to generate: ${e.message}`)}}),M=e=>{d?.find(T=>T.id===e)&&R.mutate({taskId:e,modifiedContent:g?{responseText:g}:void 0})},F=e=>{const c=prompt("Reason for rejection:");c&&k.mutate({taskId:e,reason:c})},E=e=>{S.mutate({reviewId:e.id,guestName:e.guest_name,rating:e.rating,comment:e.comment,negativeComment:e.negative_comment,positiveComment:e.positive_comment,language:e.guest_country==="GE"?"ka":e.guest_country==="RU"?"ru":"en"})};return s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:94",className:"container mx-auto p-6 space-y-6",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:96",className:"flex items-center justify-between",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:97",children:[s.jsxs("h1",{"data-loc":"client/src/pages/reservations/Automations.tsx:98",className:"text-4xl font-bold flex items-center gap-3",children:[s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:99",className:"h-12 w-12 rounded-full bg-gradient-to-r from-purple-600 to-blue-600 flex items-center justify-center",children:s.jsx(P,{"data-loc":"client/src/pages/reservations/Automations.tsx:100",className:"h-6 w-6 text-white"})}),"Booking.com Butler"]}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:104",className:"text-muted-foreground mt-2",children:"AI-powered automation dashboard"})]}),s.jsxs(A,{"data-loc":"client/src/pages/reservations/Automations.tsx:106",variant:"default",className:"bg-green-600 text-lg px-4 py-2",children:[s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:107",className:"h-3 w-3 rounded-full bg-white mr-2 animate-pulse"}),"Active"]})]}),s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:113",className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:114",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:115",className:"pb-2",children:s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:116",className:"text-sm font-medium",children:"Pending Tasks"})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:118",children:[s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:119",className:"text-3xl font-bold",children:d?.length||0}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:120",className:"text-xs text-muted-foreground mt-1",children:"Awaiting your approval"})]})]}),s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:124",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:125",className:"pb-2",children:s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:126",className:"text-sm font-medium",children:"Unanswered Reviews"})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:128",children:[s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:129",className:"text-3xl font-bold",children:u?.length||0}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:130",className:"text-xs text-muted-foreground mt-1",children:"Need response"})]})]}),s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:134",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:135",className:"pb-2",children:s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:136",className:"text-sm font-medium",children:"Tasks Completed (30d)"})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:138",children:[s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:139",className:"text-3xl font-bold",children:w?.completed||0}),s.jsxs("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:140",className:"text-xs text-green-600 mt-1",children:["+",w?.approved||0," approved"]})]})]}),s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:144",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:145",className:"pb-2",children:s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:146",className:"text-sm font-medium",children:"Time Saved"})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:148",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:149",className:"text-3xl font-bold",children:[w?.timeSaved.toFixed(1)||0,"h"]}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:150",className:"text-xs text-muted-foreground mt-1",children:"Last 30 days"})]})]})]}),s.jsxs(O,{"data-loc":"client/src/pages/reservations/Automations.tsx:156",defaultValue:"pending",className:"space-y-4",children:[s.jsxs(U,{"data-loc":"client/src/pages/reservations/Automations.tsx:157",children:[s.jsxs(N,{"data-loc":"client/src/pages/reservations/Automations.tsx:158",value:"pending",className:"flex items-center gap-2",children:[s.jsx(B,{"data-loc":"client/src/pages/reservations/Automations.tsx:159",className:"h-4 w-4"}),"Pending Tasks (",d?.length||0,")"]}),s.jsxs(N,{"data-loc":"client/src/pages/reservations/Automations.tsx:162",value:"reviews",className:"flex items-center gap-2",children:[s.jsx(L,{"data-loc":"client/src/pages/reservations/Automations.tsx:163",className:"h-4 w-4"}),"Reviews (",u?.length||0,")"]}),s.jsxs(N,{"data-loc":"client/src/pages/reservations/Automations.tsx:166",value:"recommendations",className:"flex items-center gap-2",children:[s.jsx(v,{"data-loc":"client/src/pages/reservations/Automations.tsx:167",className:"h-4 w-4"}),"AI Recommendations"]}),s.jsxs(N,{"data-loc":"client/src/pages/reservations/Automations.tsx:170",value:"metrics",className:"flex items-center gap-2",children:[s.jsx(G,{"data-loc":"client/src/pages/reservations/Automations.tsx:171",className:"h-4 w-4"}),"Performance"]})]}),s.jsx(f,{"data-loc":"client/src/pages/reservations/Automations.tsx:177",value:"pending",className:"space-y-4",children:d&&d.length>0?d.map(e=>s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:180",className:b===e.id?"border-2 border-purple-500":"",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:181",children:s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:182",className:"flex items-start justify-between",children:s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:183",className:"flex-1",children:[s.jsxs(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:184",className:"flex items-center gap-2",children:[e.title,s.jsx(A,{"data-loc":"client/src/pages/reservations/Automations.tsx:186",variant:e.priority==="urgent"||e.priority==="high"?"destructive":"secondary",children:e.priority})]}),s.jsx(j,{"data-loc":"client/src/pages/reservations/Automations.tsx:190",className:"mt-2",children:e.description})]})})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:194",className:"space-y-4",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:196",className:"space-y-2",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:197",className:"flex items-center gap-2",children:[s.jsx(v,{"data-loc":"client/src/pages/reservations/Automations.tsx:198",className:"h-4 w-4 text-purple-600"}),s.jsx("h4",{"data-loc":"client/src/pages/reservations/Automations.tsx:199",className:"font-semibold",children:"AI Generated Response:"})]}),s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:201",className:"p-4 rounded-lg bg-muted",children:s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:202",className:"text-sm whitespace-pre-wrap",children:e.ai_suggestion.responseText})})]}),b===e.id&&s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:208",className:"space-y-2",children:[s.jsx("label",{"data-loc":"client/src/pages/reservations/Automations.tsx:209",className:"text-sm font-medium",children:"Modify Response (Optional):"}),s.jsx(D,{"data-loc":"client/src/pages/reservations/Automations.tsx:210",value:g,onChange:c=>y(c.target.value),placeholder:"Edit the AI response if needed...",className:"min-h-[100px]"})]}),s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:220",className:"flex gap-2",children:b===e.id?s.jsxs(s.Fragment,{children:[s.jsxs(x,{"data-loc":"client/src/pages/reservations/Automations.tsx:223",onClick:()=>M(e.id),disabled:R.isPending,className:"flex-1",children:[s.jsx(h,{"data-loc":"client/src/pages/reservations/Automations.tsx:228",className:"h-4 w-4 mr-2"}),g?"Approve with Changes":"Approve & Send"]}),s.jsx(x,{"data-loc":"client/src/pages/reservations/Automations.tsx:231",onClick:()=>{p(null),y("")},variant:"outline",children:"Cancel"})]}):s.jsxs(s.Fragment,{children:[s.jsx(x,{"data-loc":"client/src/pages/reservations/Automations.tsx:243",onClick:()=>p(e.id),variant:"default",className:"flex-1",children:"Review & Approve"}),s.jsxs(x,{"data-loc":"client/src/pages/reservations/Automations.tsx:250",onClick:()=>F(e.id),variant:"destructive",disabled:k.isPending,children:[s.jsx(Q,{"data-loc":"client/src/pages/reservations/Automations.tsx:255",className:"h-4 w-4 mr-2"}),"Reject"]})]})})]})]},e.id)):s.jsx(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:265",children:s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:266",className:"py-12 text-center",children:[s.jsx(h,{"data-loc":"client/src/pages/reservations/Automations.tsx:267",className:"h-12 w-12 mx-auto text-green-600 mb-4"}),s.jsx("h3",{"data-loc":"client/src/pages/reservations/Automations.tsx:268",className:"text-lg font-semibold mb-2",children:"All caught up!"}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:269",className:"text-muted-foreground",children:"No pending tasks at the moment."})]})})}),s.jsx(f,{"data-loc":"client/src/pages/reservations/Automations.tsx:276",value:"reviews",className:"space-y-4",children:u&&u.length>0?u.map(e=>s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:279",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:280",children:s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:281",className:"flex items-start justify-between",children:s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:282",children:[s.jsxs(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:283",className:"flex items-center gap-2",children:[e.guest_name,s.jsxs(A,{"data-loc":"client/src/pages/reservations/Automations.tsx:285",variant:e.rating<5?"destructive":e.rating>=7?"default":"secondary",children:[e.rating,"/10"]})]}),s.jsxs(j,{"data-loc":"client/src/pages/reservations/Automations.tsx:289",children:[e.guest_country," â€¢ ",new Date(e.review_date).toLocaleDateString()]})]})})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:295",className:"space-y-4",children:[e.comment&&s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:297",children:[s.jsx("h4",{"data-loc":"client/src/pages/reservations/Automations.tsx:298",className:"font-semibold mb-2",children:"Comment:"}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:299",className:"text-sm",children:e.comment})]}),e.negative_comment&&s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:303",children:[s.jsx("h4",{"data-loc":"client/src/pages/reservations/Automations.tsx:304",className:"font-semibold mb-2 text-red-600",children:"Negative:"}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:305",className:"text-sm",children:e.negative_comment})]}),e.positive_comment&&s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:309",children:[s.jsx("h4",{"data-loc":"client/src/pages/reservations/Automations.tsx:310",className:"font-semibold mb-2 text-green-600",children:"Positive:"}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:311",className:"text-sm",children:e.positive_comment})]}),s.jsxs(x,{"data-loc":"client/src/pages/reservations/Automations.tsx:314",onClick:()=>E(e),disabled:S.isPending,children:[s.jsx(v,{"data-loc":"client/src/pages/reservations/Automations.tsx:318",className:"h-4 w-4 mr-2"}),"Generate AI Response"]})]})]},e.id)):s.jsx(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:325",children:s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:326",className:"py-12 text-center",children:[s.jsx(h,{"data-loc":"client/src/pages/reservations/Automations.tsx:327",className:"h-12 w-12 mx-auto text-green-600 mb-4"}),s.jsx("h3",{"data-loc":"client/src/pages/reservations/Automations.tsx:328",className:"text-lg font-semibold mb-2",children:"All reviews answered!"}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:329",className:"text-muted-foreground",children:"Great job staying on top of guest feedback."})]})})}),s.jsx(f,{"data-loc":"client/src/pages/reservations/Automations.tsx:336",value:"recommendations",className:"space-y-4",children:l&&s.jsxs(s.Fragment,{children:[l.alerts.length>0&&s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:341",className:"space-y-4",children:[s.jsxs("h3",{"data-loc":"client/src/pages/reservations/Automations.tsx:342",className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx($,{"data-loc":"client/src/pages/reservations/Automations.tsx:343",className:"h-5 w-5 text-red-600"}),"Critical Alerts"]}),l.alerts.map((e,c)=>s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:347",className:"border-red-200 dark:border-red-900",children:[s.jsxs(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:348",children:[s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:349",className:"text-red-900 dark:text-red-100",children:e.title}),s.jsx(j,{"data-loc":"client/src/pages/reservations/Automations.tsx:350",children:e.description})]}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:352",children:[s.jsx("h4",{"data-loc":"client/src/pages/reservations/Automations.tsx:353",className:"font-semibold mb-2",children:"Suggestions:"}),s.jsx("ul",{"data-loc":"client/src/pages/reservations/Automations.tsx:354",className:"list-disc list-inside space-y-1",children:e.suggestions.map((T,I)=>s.jsx("li",{"data-loc":"client/src/pages/reservations/Automations.tsx:356",className:"text-sm",children:T},I))})]})]},c))]}),l.recommendations.length>0&&s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:367",className:"space-y-4",children:[s.jsxs("h3",{"data-loc":"client/src/pages/reservations/Automations.tsx:368",className:"text-lg font-semibold flex items-center gap-2",children:[s.jsx(v,{"data-loc":"client/src/pages/reservations/Automations.tsx:369",className:"h-5 w-5 text-purple-600"}),"Smart Recommendations"]}),l.recommendations.map((e,c)=>s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:373",className:"border-blue-200 dark:border-blue-900",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:374",children:s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:375",className:"flex items-start justify-between",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:376",children:[s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:377",className:"text-blue-900 dark:text-blue-100",children:e.title}),s.jsx(j,{"data-loc":"client/src/pages/reservations/Automations.tsx:378",children:e.description})]}),s.jsx(A,{"data-loc":"client/src/pages/reservations/Automations.tsx:380",variant:e.priority==="high"?"destructive":"secondary",children:e.priority})]})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:385",className:"space-y-2",children:[e.estimatedImpact&&s.jsx("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:387",className:"p-3 rounded-lg bg-green-50 dark:bg-green-950/20",children:s.jsxs("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:388",className:"text-sm font-semibold text-green-900 dark:text-green-100",children:["ðŸ’° Estimated Impact: ",e.estimatedImpact]})}),s.jsx(x,{"data-loc":"client/src/pages/reservations/Automations.tsx:393",children:"Take Action"})]})]},c))]}),l.alerts.length===0&&l.recommendations.length===0&&s.jsx(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:401",children:s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:402",className:"py-12 text-center",children:[s.jsx(h,{"data-loc":"client/src/pages/reservations/Automations.tsx:403",className:"h-12 w-12 mx-auto text-green-600 mb-4"}),s.jsx("h3",{"data-loc":"client/src/pages/reservations/Automations.tsx:404",className:"text-lg font-semibold mb-2",children:"Everything looks good!"}),s.jsx("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:405",className:"text-muted-foreground",children:"No critical issues or recommendations at this time."})]})})]})}),s.jsx(f,{"data-loc":"client/src/pages/reservations/Automations.tsx:414",value:"metrics",className:"space-y-4",children:s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:415",className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:416",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:417",children:s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:418",children:"Occupancy Rate"})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:420",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:421",className:"text-4xl font-bold",children:[n?.latest?.occupancy_rate?.toFixed(1)||0,"%"]}),s.jsxs("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:422",className:"text-sm text-muted-foreground mt-2",children:[n?.trends?.occupancyChange&&n.trends.occupancyChange>0?"â†‘":"â†“",Math.abs(n?.trends?.occupancyChange||0).toFixed(1),"% vs yesterday"]})]})]}),s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:429",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:430",children:s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:431",children:"Review Score"})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:433",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:434",className:"text-4xl font-bold",children:[n?.latest?.review_score?.toFixed(1)||0,"/10"]}),s.jsxs("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:435",className:"text-sm text-muted-foreground mt-2",children:[n?.trends?.reviewScoreChange&&n.trends.reviewScoreChange>0?"â†‘":"â†“",Math.abs(n?.trends?.reviewScoreChange||0).toFixed(2)," vs yesterday"]})]})]}),s.jsxs(t,{"data-loc":"client/src/pages/reservations/Automations.tsx:442",children:[s.jsx(o,{"data-loc":"client/src/pages/reservations/Automations.tsx:443",children:s.jsx(r,{"data-loc":"client/src/pages/reservations/Automations.tsx:444",children:"Revenue (30d)"})}),s.jsxs(a,{"data-loc":"client/src/pages/reservations/Automations.tsx:446",children:[s.jsxs("div",{"data-loc":"client/src/pages/reservations/Automations.tsx:447",className:"text-4xl font-bold",children:["â‚¾",(n?.latest?.total_revenue||0).toLocaleString()]}),s.jsxs("p",{"data-loc":"client/src/pages/reservations/Automations.tsx:448",className:"text-sm text-muted-foreground mt-2",children:[n?.trends?.revenueChange&&n.trends.revenueChange>0?"â†‘":"â†“","â‚¾",Math.abs(n?.trends?.revenueChange||0).toLocaleString()," vs yesterday"]})]})]})]})})]})]})}export{K as default};
