import{j as e,b3 as _,r as c,a5 as V,m as C,aD as W,aS as J,i as K,b4 as X,b5 as B,$ as L,aE as Y,at as Z,k as R,ax as ee}from"./react-vendor-BIDRRw8F.js";import{G as te}from"./GoogleGmailConnect-BZfLkiCn.js";import{j as se,C as l,b as r,d as m,c as d,a as i,B as T}from"./index-BLcOQO7i.js";import{B as A}from"./badge-BATP3r_Y.js";import{I as ae}from"./input-BuEOZAZD.js";import{u as ne}from"./use-toast-2UsIGyGT.js";import{s as M}from"./client-C3pdvDkS.js";import{A as ce,b as le}from"./alert-DhTQNDzo.js";import{S as ie}from"./scroll-area-C9ECY_El.js";import{T as oe,a as re,b as w,c as k}from"./tabs-D52QQNv5.js";import"./trpc-vendor-wm-eNDph.js";import"./vendor-INCMKllo.js";function me({className:h,orientation:N="horizontal",decorative:u=!0,...E}){return e.jsx(_,{"data-loc":"client/src/components/ui/separator.tsx:13","data-slot":"separator",decorative:u,orientation:N,className:se("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",h),...E})}const de=()=>{const[h,N]=c.useState([]),[u,E]=c.useState([]),[b,S]=c.useState(!1),[v,U]=c.useState(!1),[j,D]=c.useState(""),[f,G]=c.useState("all"),[g,F]=c.useState({total:0,unread:0,important:0,spam:0,categories:{booking:0,guest:0,marketing:0,operational:0,other:0}}),{toast:I}=ne(),P=async()=>{try{const{data:{user:t}}=await M.auth.getUser();if(!t)return;const{data:s}=await M.from("google_tokens").select("*").eq("user_id",t.id).maybeSingle();U(!!s)}catch(t){console.error("Error checking connection:",t)}},q=t=>{const s=t.subject.toLowerCase(),n=t.from.toLowerCase(),a=t.snippet.toLowerCase();let p="other",x="normal",y="neutral";const o=[];return s.includes("booking")||s.includes("reservation")||n.includes("booking.com")||n.includes("airbnb")||n.includes("expedia")?(p="booking",x="high",o.push("Review booking details"),o.push("Update calendar")):s.includes("guest")||s.includes("review")||s.includes("feedback")||s.includes("complaint")?(p="guest",x=a.includes("urgent")||a.includes("complaint")?"high":"normal",o.push("Respond to guest"),a.includes("thank")||a.includes("great")||a.includes("excellent")?y="positive":(a.includes("problem")||a.includes("issue")||a.includes("complaint"))&&(y="negative",x="high")):s.includes("marketing")||s.includes("promotion")||s.includes("newsletter")||s.includes("unsubscribe")||n.includes("marketing")||n.includes("newsletter")?(p="marketing",x="low",o.push("Consider unsubscribing"),o.push("Move to archive")):(s.includes("invoice")||s.includes("payment")||s.includes("maintenance")||s.includes("housekeeping")||s.includes("staff"))&&(p="operational",x="normal",o.push("Review and process")),(a.includes("click here now")||a.includes("limited time offer")||a.includes("act now")||s.includes("re:")&&!t.threadId)&&o.push("Mark as spam"),{...t,category:p,priority:x,sentiment:y,suggestedActions:o}},O=t=>{const s=t.map(q),n={total:s.length,unread:s.filter(a=>a.labelIds.includes("UNREAD")).length,important:s.filter(a=>a.priority==="high").length,spam:s.filter(a=>a.suggestedActions?.includes("Mark as spam")).length,categories:{booking:s.filter(a=>a.category==="booking").length,guest:s.filter(a=>a.category==="guest").length,marketing:s.filter(a=>a.category==="marketing").length,operational:s.filter(a=>a.category==="operational").length,other:s.filter(a=>a.category==="other").length}};F(n),N(s),E(s)},z=async()=>{S(!0);try{const{data:t,error:s}=await M.functions.invoke("gmail-fetch-messages",{body:{maxResults:50}});if(s)throw s;if(t.error)throw new Error(t.error);O(t.messages||[]),I({title:"âœ… Emails Analyzed",description:`${t.messages?.length||0} emails processed with AI`})}catch(t){console.error("Error fetching messages:",t),I({title:"Error",description:t instanceof Error?t.message:"Failed to fetch emails",variant:"destructive"})}finally{S(!1)}},$=()=>{let t=h;if(f!=="all"&&(t=t.filter(s=>s.category===f)),j){const s=j.toLowerCase();t=t.filter(n=>n.subject.toLowerCase().includes(s)||n.from.toLowerCase().includes(s)||n.snippet.toLowerCase().includes(s))}E(t)};c.useEffect(()=>{P()},[]),c.useEffect(()=>{v&&z()},[v]),c.useEffect(()=>{$()},[j,f,h]);const H=t=>{switch(t){case"high":return"destructive";case"normal":return"default";case"low":return"secondary";default:return"outline"}},Q=t=>{switch(t){case"positive":return"ðŸ˜Š";case"negative":return"ðŸ˜Ÿ";default:return"ðŸ˜"}};return v?e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:300",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:302",className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs(l,{"data-loc":"client/src/components/EmailAgent.tsx:303",children:[e.jsxs(r,{"data-loc":"client/src/components/EmailAgent.tsx:304",className:"pb-2",children:[e.jsx(m,{"data-loc":"client/src/components/EmailAgent.tsx:305",children:"Total Emails"}),e.jsx(d,{"data-loc":"client/src/components/EmailAgent.tsx:306",className:"text-3xl",children:g.total})]}),e.jsx(i,{"data-loc":"client/src/components/EmailAgent.tsx:308",children:e.jsx(C,{"data-loc":"client/src/components/EmailAgent.tsx:309",className:"h-4 w-4 text-muted-foreground"})})]}),e.jsxs(l,{"data-loc":"client/src/components/EmailAgent.tsx:313",children:[e.jsxs(r,{"data-loc":"client/src/components/EmailAgent.tsx:314",className:"pb-2",children:[e.jsx(m,{"data-loc":"client/src/components/EmailAgent.tsx:315",children:"Unread"}),e.jsx(d,{"data-loc":"client/src/components/EmailAgent.tsx:316",className:"text-3xl text-blue-600",children:g.unread})]}),e.jsx(i,{"data-loc":"client/src/components/EmailAgent.tsx:318",children:e.jsx(W,{"data-loc":"client/src/components/EmailAgent.tsx:319",className:"h-4 w-4 text-blue-600"})})]}),e.jsxs(l,{"data-loc":"client/src/components/EmailAgent.tsx:323",children:[e.jsxs(r,{"data-loc":"client/src/components/EmailAgent.tsx:324",className:"pb-2",children:[e.jsx(m,{"data-loc":"client/src/components/EmailAgent.tsx:325",children:"High Priority"}),e.jsx(d,{"data-loc":"client/src/components/EmailAgent.tsx:326",className:"text-3xl text-red-600",children:g.important})]}),e.jsx(i,{"data-loc":"client/src/components/EmailAgent.tsx:328",children:e.jsx(J,{"data-loc":"client/src/components/EmailAgent.tsx:329",className:"h-4 w-4 text-red-600"})})]}),e.jsxs(l,{"data-loc":"client/src/components/EmailAgent.tsx:333",children:[e.jsxs(r,{"data-loc":"client/src/components/EmailAgent.tsx:334",className:"pb-2",children:[e.jsx(m,{"data-loc":"client/src/components/EmailAgent.tsx:335",children:"Bookings"}),e.jsx(d,{"data-loc":"client/src/components/EmailAgent.tsx:336",className:"text-3xl text-green-600",children:g.categories.booking})]}),e.jsx(i,{"data-loc":"client/src/components/EmailAgent.tsx:338",children:e.jsx(K,{"data-loc":"client/src/components/EmailAgent.tsx:339",className:"h-4 w-4 text-green-600"})})]}),e.jsxs(l,{"data-loc":"client/src/components/EmailAgent.tsx:343",children:[e.jsxs(r,{"data-loc":"client/src/components/EmailAgent.tsx:344",className:"pb-2",children:[e.jsx(m,{"data-loc":"client/src/components/EmailAgent.tsx:345",children:"Spam Detected"}),e.jsx(d,{"data-loc":"client/src/components/EmailAgent.tsx:346",className:"text-3xl text-orange-600",children:g.spam})]}),e.jsx(i,{"data-loc":"client/src/components/EmailAgent.tsx:348",children:e.jsx(X,{"data-loc":"client/src/components/EmailAgent.tsx:349",className:"h-4 w-4 text-orange-600"})})]})]}),e.jsxs(l,{"data-loc":"client/src/components/EmailAgent.tsx:355",className:"border-primary/20",children:[e.jsx(r,{"data-loc":"client/src/components/EmailAgent.tsx:356",children:e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:357",className:"flex items-center justify-between",children:[e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:358",className:"flex items-center gap-3",children:[e.jsx("div",{"data-loc":"client/src/components/EmailAgent.tsx:359",className:"flex h-10 w-10 items-center justify-center rounded-lg bg-gradient-to-br from-purple-500 to-pink-600",children:e.jsx(B,{"data-loc":"client/src/components/EmailAgent.tsx:360",className:"h-5 w-5 text-white"})}),e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:362",children:[e.jsxs(d,{"data-loc":"client/src/components/EmailAgent.tsx:363",className:"text-xl flex items-center gap-2",children:["AI Email Agent",e.jsx(L,{"data-loc":"client/src/components/EmailAgent.tsx:365",className:"h-4 w-4 text-yellow-500"})]}),e.jsx(m,{"data-loc":"client/src/components/EmailAgent.tsx:367",children:"Intelligent email processing and management"})]})]}),e.jsxs(T,{"data-loc":"client/src/components/EmailAgent.tsx:372",onClick:z,disabled:b,variant:"outline",size:"sm",children:[e.jsx(Y,{"data-loc":"client/src/components/EmailAgent.tsx:378",className:`h-4 w-4 mr-2 ${b?"animate-spin":""}`}),"Refresh & Analyze"]})]})}),e.jsxs(i,{"data-loc":"client/src/components/EmailAgent.tsx:383",children:[e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:385",className:"flex gap-2 mb-4",children:[e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:386",className:"relative flex-1",children:[e.jsx(Z,{"data-loc":"client/src/components/EmailAgent.tsx:387",className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground"}),e.jsx(ae,{"data-loc":"client/src/components/EmailAgent.tsx:388",placeholder:"Search emails by subject, sender, or content...",value:j,onChange:t=>D(t.target.value),className:"pl-10"})]}),e.jsxs("select",{"data-loc":"client/src/components/EmailAgent.tsx:395",value:f,onChange:t=>G(t.target.value),className:"px-4 py-2 border rounded-md bg-background",children:[e.jsx("option",{"data-loc":"client/src/components/EmailAgent.tsx:400",value:"all",children:"All Categories"}),e.jsx("option",{"data-loc":"client/src/components/EmailAgent.tsx:401",value:"booking",children:"Bookings"}),e.jsx("option",{"data-loc":"client/src/components/EmailAgent.tsx:402",value:"guest",children:"Guest Communication"}),e.jsx("option",{"data-loc":"client/src/components/EmailAgent.tsx:403",value:"operational",children:"Operational"}),e.jsx("option",{"data-loc":"client/src/components/EmailAgent.tsx:404",value:"marketing",children:"Marketing"}),e.jsx("option",{"data-loc":"client/src/components/EmailAgent.tsx:405",value:"other",children:"Other"})]})]}),e.jsx(me,{"data-loc":"client/src/components/EmailAgent.tsx:409",className:"my-4"}),e.jsx(ie,{"data-loc":"client/src/components/EmailAgent.tsx:412",className:"h-[600px]",children:u.length===0&&!b?e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:414",className:"text-center py-8 text-muted-foreground",children:[e.jsx(C,{"data-loc":"client/src/components/EmailAgent.tsx:415",className:"h-12 w-12 mx-auto mb-2 opacity-20"}),e.jsx("p",{"data-loc":"client/src/components/EmailAgent.tsx:416",children:"No emails found"})]}):e.jsx("div",{"data-loc":"client/src/components/EmailAgent.tsx:419",className:"space-y-3",children:u.map(t=>e.jsx(l,{"data-loc":"client/src/components/EmailAgent.tsx:421",className:"border-muted hover:border-primary/50 transition-colors",children:e.jsx(i,{"data-loc":"client/src/components/EmailAgent.tsx:422",className:"pt-4",children:e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:423",className:"space-y-3",children:[e.jsx("div",{"data-loc":"client/src/components/EmailAgent.tsx:425",className:"flex items-start justify-between gap-2",children:e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:426",className:"flex-1",children:[e.jsx("h4",{"data-loc":"client/src/components/EmailAgent.tsx:427",className:"font-semibold text-sm line-clamp-1 mb-1",children:t.subject||"(No subject)"}),e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:430",className:"flex flex-wrap gap-1",children:[e.jsx(A,{"data-loc":"client/src/components/EmailAgent.tsx:431",variant:H(t.priority),className:"text-xs",children:t.priority?.toUpperCase()}),e.jsx(A,{"data-loc":"client/src/components/EmailAgent.tsx:434",variant:"outline",className:"text-xs",children:t.category}),t.labelIds.includes("UNREAD")&&e.jsx(A,{"data-loc":"client/src/components/EmailAgent.tsx:438",variant:"default",className:"text-xs",children:"NEW"}),t.sentiment&&t.sentiment!=="neutral"&&e.jsxs(A,{"data-loc":"client/src/components/EmailAgent.tsx:443",variant:"outline",className:"text-xs",children:[Q(t.sentiment)," ",t.sentiment]})]})]})}),e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:452",className:"text-xs text-muted-foreground",children:[e.jsxs("p",{"data-loc":"client/src/components/EmailAgent.tsx:453",className:"line-clamp-1",children:[e.jsx("span",{"data-loc":"client/src/components/EmailAgent.tsx:454",className:"font-medium",children:"From:"})," ",t.from]}),e.jsx("p",{"data-loc":"client/src/components/EmailAgent.tsx:456",className:"mt-1",children:t.date})]}),e.jsx("p",{"data-loc":"client/src/components/EmailAgent.tsx:460",className:"text-sm text-muted-foreground line-clamp-2",children:t.snippet}),t.suggestedActions&&t.suggestedActions.length>0&&e.jsxs("div",{"data-loc":"client/src/components/EmailAgent.tsx:466",className:"pt-2 border-t",children:[e.jsxs("p",{"data-loc":"client/src/components/EmailAgent.tsx:467",className:"text-xs font-medium text-muted-foreground mb-2 flex items-center gap-1",children:[e.jsx(L,{"data-loc":"client/src/components/EmailAgent.tsx:468",className:"h-3 w-3"}),"AI Suggestions:"]}),e.jsx("div",{"data-loc":"client/src/components/EmailAgent.tsx:471",className:"flex flex-wrap gap-2",children:t.suggestedActions.map((s,n)=>e.jsx(T,{"data-loc":"client/src/components/EmailAgent.tsx:473",variant:"outline",size:"sm",className:"text-xs h-7",children:s},n))})]})]})})},t.id))})})]})]})]}):e.jsxs(ce,{"data-loc":"client/src/components/EmailAgent.tsx:290",children:[e.jsx(V,{"data-loc":"client/src/components/EmailAgent.tsx:291",className:"h-4 w-4"}),e.jsx(le,{"data-loc":"client/src/components/EmailAgent.tsx:292",children:"Gmail connection required. Please connect Gmail above to use the Email Agent."})]})},ye=()=>e.jsxs("div",{"data-loc":"client/src/pages/EmailManagement.tsx:9",className:"container mx-auto p-6 space-y-6",children:[e.jsx("div",{"data-loc":"client/src/pages/EmailManagement.tsx:11",className:"flex items-center justify-between",children:e.jsxs("div",{"data-loc":"client/src/pages/EmailManagement.tsx:12",children:[e.jsxs("h1",{"data-loc":"client/src/pages/EmailManagement.tsx:13",className:"text-3xl font-bold tracking-tight flex items-center gap-2",children:[e.jsx(C,{"data-loc":"client/src/pages/EmailManagement.tsx:14",className:"h-8 w-8 text-primary"}),"Email Management"]}),e.jsx("p",{"data-loc":"client/src/pages/EmailManagement.tsx:17",className:"text-muted-foreground mt-1",children:"AI-powered email processing and intelligent inbox management"})]})}),e.jsx(te,{"data-loc":"client/src/pages/EmailManagement.tsx:24"}),e.jsxs(oe,{"data-loc":"client/src/pages/EmailManagement.tsx:27",defaultValue:"agent",className:"w-full",children:[e.jsxs(re,{"data-loc":"client/src/pages/EmailManagement.tsx:28",className:"grid w-full grid-cols-3",children:[e.jsxs(w,{"data-loc":"client/src/pages/EmailManagement.tsx:29",value:"agent",className:"flex items-center gap-2",children:[e.jsx(B,{"data-loc":"client/src/pages/EmailManagement.tsx:30",className:"h-4 w-4"}),"AI Agent"]}),e.jsxs(w,{"data-loc":"client/src/pages/EmailManagement.tsx:33",value:"analytics",className:"flex items-center gap-2",children:[e.jsx(R,{"data-loc":"client/src/pages/EmailManagement.tsx:34",className:"h-4 w-4"}),"Analytics"]}),e.jsxs(w,{"data-loc":"client/src/pages/EmailManagement.tsx:37",value:"settings",className:"flex items-center gap-2",children:[e.jsx(ee,{"data-loc":"client/src/pages/EmailManagement.tsx:38",className:"h-4 w-4"}),"Settings"]})]}),e.jsx(k,{"data-loc":"client/src/pages/EmailManagement.tsx:43",value:"agent",className:"mt-6",children:e.jsx(de,{"data-loc":"client/src/pages/EmailManagement.tsx:44"})}),e.jsx(k,{"data-loc":"client/src/pages/EmailManagement.tsx:47",value:"analytics",className:"mt-6",children:e.jsxs(l,{"data-loc":"client/src/pages/EmailManagement.tsx:48",children:[e.jsxs(r,{"data-loc":"client/src/pages/EmailManagement.tsx:49",children:[e.jsx(d,{"data-loc":"client/src/pages/EmailManagement.tsx:50",children:"Email Analytics"}),e.jsx(m,{"data-loc":"client/src/pages/EmailManagement.tsx:51",children:"Insights and trends from your email communications"})]}),e.jsx(i,{"data-loc":"client/src/pages/EmailManagement.tsx:55",children:e.jsxs("div",{"data-loc":"client/src/pages/EmailManagement.tsx:56",className:"text-center py-12 text-muted-foreground",children:[e.jsx(R,{"data-loc":"client/src/pages/EmailManagement.tsx:57",className:"h-16 w-16 mx-auto mb-4 opacity-20"}),e.jsx("p",{"data-loc":"client/src/pages/EmailManagement.tsx:58",className:"text-lg font-medium",children:"Analytics Dashboard"}),e.jsx("p",{"data-loc":"client/src/pages/EmailManagement.tsx:59",className:"text-sm mt-2",children:"Email analytics and insights will be displayed here"})]})})]})}),e.jsx(k,{"data-loc":"client/src/pages/EmailManagement.tsx:67",value:"settings",className:"mt-6",children:e.jsxs(l,{"data-loc":"client/src/pages/EmailManagement.tsx:68",children:[e.jsxs(r,{"data-loc":"client/src/pages/EmailManagement.tsx:69",children:[e.jsx(d,{"data-loc":"client/src/pages/EmailManagement.tsx:70",children:"Email Agent Settings"}),e.jsx(m,{"data-loc":"client/src/pages/EmailManagement.tsx:71",children:"Configure AI behavior and automation rules"})]}),e.jsx(i,{"data-loc":"client/src/pages/EmailManagement.tsx:75",children:e.jsxs("div",{"data-loc":"client/src/pages/EmailManagement.tsx:76",className:"space-y-4",children:[e.jsxs("div",{"data-loc":"client/src/pages/EmailManagement.tsx:77",className:"text-sm text-muted-foreground",children:[e.jsx("h3",{"data-loc":"client/src/pages/EmailManagement.tsx:78",className:"font-medium text-foreground mb-2",children:"Automation Features:"}),e.jsxs("ul",{"data-loc":"client/src/pages/EmailManagement.tsx:79",className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:80",children:"Automatic email categorization (Booking, Guest, Operational, Marketing)"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:81",children:"Priority detection and flagging"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:82",children:"Sentiment analysis for guest communications"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:83",children:"Smart spam detection"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:84",children:"Suggested actions based on email content"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:85",children:"Unsubscribe recommendations for marketing emails"})]})]}),e.jsxs("div",{"data-loc":"client/src/pages/EmailManagement.tsx:89",className:"text-sm text-muted-foreground mt-6",children:[e.jsx("h3",{"data-loc":"client/src/pages/EmailManagement.tsx:90",className:"font-medium text-foreground mb-2",children:"Coming Soon:"}),e.jsxs("ul",{"data-loc":"client/src/pages/EmailManagement.tsx:91",className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:92",children:"Automatic response templates"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:93",children:"Email scheduling and follow-ups"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:94",children:"Integration with booking system"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:95",children:"Multi-language support"}),e.jsx("li",{"data-loc":"client/src/pages/EmailManagement.tsx:96",children:"Advanced analytics and reporting"})]})]})]})})]})})]})]});export{ye as default};
